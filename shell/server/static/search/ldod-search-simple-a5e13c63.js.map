{"version":3,"file":"ldod-search-simple-a5e13c63.js","sources":["../src/constants.jsx","../src/pages/search-simple/search-component.jsx","../src/pages/search-simple/simple-search-table.jsx","../src/pages/search-simple/ldod-search-simple.jsx"],"sourcesContent":["export default (frags, inters) => ({\n  headers: ['fragments', 'interpretations'],\n  jpc: 'Jacinto Prado Coelho',\n  tsc: 'Teresa Sobral Cunha',\n  rz: 'Richard Zenith',\n  jp: 'Jerónimo Pizarro',\n  pt: {\n    all: 'Todas',\n    witnesses: 'Testemunhos',\n    searchSimple: 'Pesquisa Simples',\n    searchFor: 'Pesquisar por...',\n    searchType: 'Tipo de pesquisa',\n    searchSource: 'Tipos de fonte',\n    titleSearch: 'Pesquisa por título',\n    completeSearch: 'Pesquisa completa',\n    fragment: 'Fragmento',\n    fragments: (\n      <div>\n        <span data-search-key=\"fragment\">Fragmento </span>\n        {` (${frags})`}\n      </div>\n    ),\n    interpretation: 'Interpretações',\n    interpretations: (\n      <div>\n        <span data-search-key=\"interpretation\">Interpretações</span>\n        {` (${inters})`}\n      </div>\n    ),\n  },\n  en: {\n    all: 'All',\n    witnesses: 'Witnesses',\n    searchSimple: 'Simple Search',\n    searchFor: 'Search for...',\n    searchType: 'Search type',\n    searchSource: 'Source types',\n    titleSearch: 'Search by title',\n    completeSearch: 'Full search',\n    fragment: 'Fragment',\n    fragments: (\n      <div>\n        <span data-search-key=\"fragment\">Fragment</span>\n        {` (${frags})`}\n      </div>\n    ),\n    interpretation: 'Interpretations',\n    interpretations: (\n      <div>\n        <span data-search-key=\"interpretation\">Interpretations</span>\n        {` (${inters})`}\n      </div>\n    ),\n  },\n  es: {\n    all: 'Todas',\n    witnesses: 'Testimonios',\n    searchSimple: 'Búsqueda Sencilla',\n    searchType: 'Tipo de búsqueda',\n    searchSource: 'Tipos de fuente',\n    searchFor: 'Busca por...',\n    titleSearch: 'Búsqueda por título',\n    completeSearch: 'Búsqueda completa',\n    fragment: 'Fragmento',\n    fragments: (\n      <div>\n        <span data-search-key=\"fragment\">Fragmento</span>\n        {` (${frags})`}\n      </div>\n    ),\n    interpretation: 'Interpretaciones',\n    interpretations: (\n      <div>\n        <span data-search-key=\"interpretations\">Interpretaciones</span>\n        {` (${inters})`}\n      </div>\n    ),\n  },\n});\n","import constants from '../../constants';\nexport default ({ node }) => {\n  return (\n    <form onSubmit={node.searchRequest}>\n      <div\n        style={{\n          display: 'flex',\n          justifyContent: 'center',\n          gap: '20px',\n          flexWrap: 'wrap',\n        }}>\n        <div class=\"form-floating\">\n          <input\n            id=\"searchTerm\"\n            class=\"form-control\"\n            type=\"search\"\n            name=\"searchTerm\"\n            required\n            placeholder=\"searchFor\"\n          />\n          <label data-search-key=\"searchFor\">\n            {node.getConstants('searchFor')}\n          </label>\n        </div>\n        <div class=\"form-floating\">\n          <select name=\"searchType\" class=\"form-select\" id=\"searchType\">\n            <option data-search-key=\"completeSearch\" value=\"\" selected>\n              {node.getConstants('completeSearch')}\n            </option>\n            <option data-search-key=\"titleSearch\" value=\"title\">\n              {node.getConstants('titleSearch')}\n            </option>\n          </select>\n          <label data-search-key=\"searchType\">\n            {node.getConstants('searchType')}\n          </label>\n        </div>\n\n        <div class=\"form-floating\">\n          <select name=\"searchSource\" class=\"form-select\" id=\"source\">\n            <option value=\"\" data-search-key=\"all\">\n              All\n            </option>\n            <option value=\"Coelho\">{constants().jpc}</option>\n            <option value=\"Cunha\">{constants().tsc}</option>\n            <option value=\"Pizarro\">{constants().jp}</option>\n            <option value=\"Zenith\">{constants().rz}</option>\n            <option value=\"BNP\" data-search-key=\"witnesses\">\n              {node.getConstants('witnesses')}\n            </option>\n          </select>\n          <label data-search-key=\"searchSource\">\n            {node.getConstants('searchSource')}\n          </label>\n        </div>\n\n        <button type=\"submit\" class=\"btn btn-outline-secondary\">\n          <span class=\"icon icon-magnifying-glass\"></span>\n          search\n        </button>\n      </div>\n    </form>\n  );\n};\n","/** @format */\n\nimport constants from '../../constants';\nimport { textFrag, textFragInter } from '../../external-deps';\n\nconst getTableData = inters => {\n\treturn inters.map(inter => {\n\t\treturn {\n\t\t\texternalId: inter.externalId,\n\t\t\tfragments: (\n\t\t\t\t<a is=\"nav-to\" content to={textFrag(inter.xmlId)}>\n\t\t\t\t\t{inter.title}\n\t\t\t\t</a>\n\t\t\t),\n\t\t\tinterpretations: (\n\t\t\t\t<a is=\"nav-to\" content to={textFragInter(inter.xmlId, inter.urlId)}>\n\t\t\t\t\t{`${inter.acronym ? `${inter.interTitle} (${inter.acronym})` : inter.shortName} \n          `}\n\t\t\t\t</a>\n\t\t\t),\n\t\t\tsearch: JSON.stringify(inter),\n\t\t};\n\t});\n};\n\nexport default ({ node }) => {\n\treturn (\n\t\t<div id=\"search-tableContainer\">\n\t\t\t<hr />\n\t\t\t<ldod-table\n\t\t\t\tid=\"search-simpleTable\"\n\t\t\t\tclasses=\"table table-bordered table-hover\"\n\t\t\t\theaders={constants().headers}\n\t\t\t\tdata={getTableData(node.data)}\n\t\t\t\tconstants={constants(node.numberOfFragments, node.numberOfInters)[node.language]}\n\t\t\t\tdata-searchkey=\"externalId\"></ldod-table>\n\t\t</div>\n\t);\n};\n","/** @format */\n\nimport constants from '../../constants';\nimport SearchComponent from './search-component';\nimport { simpleSearchRequest } from '../../api-requests';\nimport style from '@src/style.css?inline';\nimport SimpleSearchTable from './simple-search-table';\n\nimport.meta.env.DEV ? await import('@ui/table-dev.js') : await import('@ui/table.js');\n\nexport class LdodSearchSimple extends HTMLElement {\n\tconstructor(options) {\n\t\tsuper();\n\t\tthis.attachShadow({ mode: 'open' });\n\t\tthis.shadowRoot.appendChild(<style>{style}</style>);\n\t\tthis.mode = options?.isFragmentMode;\n\t\tthis.language = options?.language;\n\t}\n\n\tstatic get observedAttributes() {\n\t\treturn ['language'];\n\t}\n\n\tset language(lang) {\n\t\tlang && this.setAttribute('language', lang);\n\t}\n\n\tget language() {\n\t\treturn this.getAttribute('language');\n\t}\n\n\tget numberOfFragments() {\n\t\treturn new Set(this.data?.map(inter => inter.xmlId)).size;\n\t}\n\n\tget numberOfInters() {\n\t\treturn this.data?.length;\n\t}\n\n\tget isFragmentMode() {\n\t\treturn this.hasAttribute('fragment');\n\t}\n\n\tset isFragmentMode(mode) {\n\t\tthis.toggleAttribute('fragment', mode);\n\t}\n\tget selectedInters() {\n\t\treturn Array.from(this.shadowRoot.querySelectorAll('tr[selected]')).map(row => row.id);\n\t}\n\n\tgetConstants(key) {\n\t\treturn constants(this.numberOfFragments, this.numberOfInters)[this.language][key];\n\t}\n\tconnectedCallback() {\n\t\tthis.render();\n\t}\n\n\trender() {\n\t\tthis.shadowRoot.appendChild(\n\t\t\t<>\n\t\t\t\t{!this.isFragmentMode && (\n\t\t\t\t\t<h3 class=\"text-center\" data-search-key=\"searchSimple\">\n\t\t\t\t\t\t{this.getConstants('searchSimple')}\n\t\t\t\t\t</h3>\n\t\t\t\t)}\n\t\t\t\t<SearchComponent node={this} />\n\t\t\t\t<br />\n\t\t\t\t<br />\n\t\t\t\t<div id=\"search-tableContainer\"></div>\n\t\t\t</>\n\t\t);\n\t}\n\n\trenderTable() {\n\t\tthis.shadowRoot\n\t\t\t.querySelector('div#search-tableContainer')\n\t\t\t.replaceWith(<SimpleSearchTable node={this} />);\n\t\tthis.addEventListeners();\n\t}\n\n\tattributeChangedCallback(name, oldV, newV) {\n\t\tthis.onChangeAttribute[name](oldV, newV);\n\t}\n\tgetSelectedInters = () => {\n\t\tconst selected = this.selectedInters;\n\t\treturn this.data?.filter(inter => selected.indexOf(inter.externalId) !== -1);\n\t};\n\n\tonChangeAttribute = {\n\t\tlanguage: (oldV, newV) => {\n\t\t\toldV &&\n\t\t\t\toldV !== newV &&\n\t\t\t\tthis.shadowRoot.querySelectorAll('[data-search-key]').forEach(element => {\n\t\t\t\t\telement.innerHTML = this.getConstants(element.dataset.searchKey);\n\t\t\t\t});\n\t\t},\n\t};\n\n\tdisconnectedCallback() {}\n\n\taddEventListeners = () => {\n\t\tif (this.isFragmentMode) {\n\t\t\tthis.shadowRoot.querySelectorAll('table#search-simpleTable>tbody>tr').forEach(row => {\n\t\t\t\trow.addEventListener('click', this.handleRowClick);\n\t\t\t});\n\t\t}\n\t};\n\n\thandleRowClick() {\n\t\tthis.toggleAttribute('selected');\n\t}\n\n\tsearchRequest = async e => {\n\t\te.preventDefault();\n\t\tconst searchBody = Object.fromEntries(new FormData(e.target));\n\t\tthis.data = await simpleSearchRequest(searchBody);\n\t\tthis.renderTable();\n\t};\n}\n!customElements.get('ldod-search-simple') &&\n\tcustomElements.define('ldod-search-simple', LdodSearchSimple);\n"],"names":["constants","frags","inters","headers","jpc","tsc","rz","jp","pt","all","witnesses","searchSimple","searchFor","searchType","searchSource","titleSearch","completeSearch","fragment","fragments","createElement","interpretation","interpretations","en","es","SearchComponent","node","onSubmit","searchRequest","style","display","justifyContent","gap","flexWrap","class","id","type","name","required","placeholder","getConstants","value","selected","getTableData","map","inter","externalId","is","content","to","textFrag","xmlId","title","textFragInter","urlId","acronym","interTitle","shortName","search","JSON","stringify","SimpleSearchTable","classes","data","numberOfFragments","numberOfInters","language","import","LdodSearchSimple","HTMLElement","constructor","options","this","attachShadow","mode","shadowRoot","appendChild","isFragmentMode","observedAttributes","lang","setAttribute","getAttribute","Set","size","length","hasAttribute","toggleAttribute","selectedInters","Array","from","querySelectorAll","row","key","connectedCallback","render","createFragment","renderTable","querySelector","replaceWith","addEventListeners","attributeChangedCallback","oldV","newV","onChangeAttribute","getSelectedInters","filter","indexOf","forEach","element","innerHTML","dataset","searchKey","disconnectedCallback","addEventListener","handleRowClick","async","e","preventDefault","searchBody","Object","fromEntries","FormData","target","simpleSearchRequest","customElements","get","define"],"mappings":"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"}