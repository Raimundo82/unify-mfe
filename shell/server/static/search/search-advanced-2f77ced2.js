import{createElement as e,createFragment as t}from"@core";import{t as a,a as r,g as i,s as o,c as n}from"./external-deps-9fbd6a2a.js";const s=(t,a)=>({pt:{advancedSearch:"Pesquisa Avançada",criteriaAnd:"De acordo com todos os seguintes critérios",criteriaOr:"De acordo com pelo menos um dos seguintes critérios",edition:"Edição",manuscript:"Manuscrito",dactiloscript:"Datiloscrito",publication:"Publicado",heteronym:"Heterónimo",taxonomy:"Taxonomias",virtualedition:"Edições Virtuais",date:"Data",text:"Texto",includedIn:"Incluídos em",excludedFrom:"Excluídos de",all:"Todas",search:"Pesquisar",criteriaType:"Tipos de Critério",editions:"Edições",heteronyms:"Heterónimos",editionInclusion:"Inclusão na edição",veInclusion:"Inclusão na edição virtual",virtualEdition:"Edição Virtual",dated:"Datado",notDated:"Não datado",beginDate:"Desde",endDate:"Até",hasLdoDMark:"Marca Ldod",withLdodLabel:"Com marca Ldod",withoutLdodLabel:"Sem marca Ldod",keyword:"Palavras chave",fragment:"Fragmento",fragments:e("div",null,e("span",{"data-search-key":"fragment"},"Fragmento "),` (${t})`),interpretation:"Interpretações",interpretations:e("div",null,e("span",{"data-search-key":"interpretation"},"Interpretações"),` (${a})`),sourceType:"Tipos de fonte",sourceTypeHeader:e("span",{"data-search-key":"sourceType"},"Tipos de fonte"),sourcesHeader:e("span",{"data-search-key":"sources"},"Testemunhos"),sources:"Testemunhos",typescript:"Mecanografiado",both:"Manuscrito Mecanografiado",yes:"Sim",no:"Não",dateHeader:e("span",{"data-search-key":"date"},"Data"),editionHeader:e("span",{"data-search-key":"edition"},"Edição"),heteronymHeader:e("span",{"data-search-key":"heteronym"},"Heterónimo"),hasLdoDMarkHeader:e("span",{"data-search-key":"hasLdoDMark"},"Marca Ldod"),"não atribuído":"Não atribuído"},en:{advancedSearch:"Advanced Search",criteriaAnd:"Match all of the following",criteriaOr:"Match any of the following",edition:"Edition",manuscript:"Manuscript",dactiloscript:"Typescript",publication:"Published",heteronym:"Heteronym",taxonomy:"Taxonomies",virtualedition:"Virtual Editions",date:"Date",text:"Text",includedIn:"Included in",excludedFrom:"Excluded from",all:"All",search:"Search",criteriaType:"Criteria Types",editions:"Editions",heteronyms:"Heteronyms",editionInclusion:"Edition inclusion",virtualEdition:"Virtual Edition",veInclusion:"virtual edition inclusion",dated:"Dated",notDated:"Not dated",beginDate:"From",endDate:"to",hasLdoDMark:"LdoD Mark",withLdodLabel:"With LdoD mark",withoutLdodLabel:"Without LdoD mark",keyword:"Keyworks",fragment:"Fragment",fragments:e("div",null,e("span",{"data-search-key":"fragment"},"Fragment"),` (${t})`),interpretation:"Interpretations",interpretations:e("div",null,e("span",{"data-search-key":"interpretation"},"Interpretations"),` (${a})`),sourceType:"Source Types",sourceTypeHeader:e("span",{"data-search-key":"sourceType"},"Tipos de fonte"),sourcesHeader:e("span",{"data-search-key":"sources"},"Witnesses"),sources:"Witnesses",typescript:"Typescript",both:"Manuscript Typescript",yes:"Yes",no:"No",dateHeader:e("span",{"data-search-key":"date"},"Date"),editionHeader:e("span",{"data-search-key":"edition"},"Edition"),heteronymHeader:e("span",{"data-search-key":"heteronym"},"Heteronym"),hasLdoDMarkHeader:e("span",{"data-search-key":"hasLdoDMark"},"LdoD Mark"),"não atribuído":"Not assigned"},es:{advancedSearch:"Búsqueda Avanzada",criteriaAnd:"Coincidir todos de los siguientes criterios",criteriaOr:"Coincidir con pelo menos uno de los siguientes criterios",edition:"Edición",manuscript:"Manuscrito",dactiloscript:"Mecanografiado",publication:"Publicado",heteronym:"Heterónimo",taxonomy:"Taxonomías",virtualedition:"Ediciónes Virtuales",date:"Fecha",text:"Texto",includedIn:"Incluidos em",excludedFrom:"Excluidos de",all:"Todas",search:"Buscar",criteriaType:"Tipos de Critério",editions:"Ediciónes",virtualEdition:"Edición Virtuale",heteronyms:"Heterónimos",editionInclusion:"Inclusion en edición",veInclusion:"Inclusion en edición virtuale",dated:"Datado",notDated:"No datado",beginDate:"Desde",endDate:"Até",hasLdoDMark:"Marca Ldod",withLdodLabel:"Con marca Ldod",withoutLdodLabel:"Sin marca Ldod",keyword:"Palabras clave",fragment:"Fragmento",fragments:e("div",null,e("span",{"data-search-key":"fragment"},"Fragmento"),` (${t})`),interpretation:"Interpretaciones",interpretations:e("div",null,e("span",{"data-search-key":"interpretation"},"Interpretaciones"),` (${a})`),sourceType:"Tipos de fuente",sourceTypeHeader:e("span",{"data-search-key":"sourceType"},"Tipos de fuente"),sourcesHeader:e("span",{"data-search-key":"sources"},"Testimonios"),sources:"Testimonios",typescript:"Mecanografiado",both:"Manuscrito Mecanografiado",yes:"Si",no:"No",dateHeader:e("span",{"data-search-key":"date"},"Fecha"),editionHeader:e("span",{"data-search-key":"edition"},"Edición"),heteronymHeader:e("span",{"data-search-key":"heteronym"},"Heterónimo"),hasLdoDMarkHeader:e("span",{"data-search-key":"hasLdoDMark"},"Marca Ldod"),"não atribuído":"Ninguna atribuición"}}),d=async e=>(await((e,t)=>{const a=e[t];return a?"function"==typeof a?a():Promise.resolve(a):new Promise(((e,a)=>{("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(a.bind(null,new Error("Unknown variable dynamic import: "+t)))}))})(Object.assign({"./components/AdvancedSearchTableResult.jsx":()=>Promise.resolve().then((()=>m)),"./components/dactiloscript.jsx":()=>import("./dactiloscript-80759fe7.js"),"./components/date.jsx":()=>import("./date-f829c680.js"),"./components/dateWebComp.jsx":()=>import("./dateWebComp-fa583fd8.js"),"./components/edition.jsx":()=>import("./edition-e81bd722.js"),"./components/heteronym.jsx":()=>import("./heteronym-e2cbff83.js"),"./components/heteronymWebComp.jsx":()=>import("./heteronymWebComp-2e31ec10.js"),"./components/manuscript.jsx":()=>import("./manuscript-635d768e.js"),"./components/publication.jsx":()=>import("./publication-d33ced12.js"),"./components/sourceWebComp.jsx":()=>import("./sourceWebComp-9b200ab1.js"),"./components/taxonomy.jsx":()=>import("./taxonomy-d8db5e65.js"),"./components/text.jsx":()=>import("./text-6b3dce1a.js"),"./components/virtualedition.jsx":()=>import("./virtualedition-1e3a9102.js")}),`./components/${e}.jsx`)).default,c=["edition","manuscript","dactiloscript","publication","heteronym","taxonomy","virtualedition","date","text"];class l extends HTMLFormElement{constructor(){super()}get criteria(){return this.getAttribute("criteria")}get criteriaFormElement(){return this.querySelector("#criteria-form")}static get observedAttributes(){return["criteria"]}connectedCallback(){this.render()}render(){this.appendChild(e(t,null,e("hr",null),e("div",{id:"criteria-container"},e("div",{class:"form-floating"},e("select",{required:!0,name:"type",class:"form-select",onChange:this.onChangeCriteria},e("option",{selected:!0}),c.map((t=>e("option",{value:t,"data-search-key":t},this.root.getConstants(t))))),e("label",{"data-search-key":"criteriaType"},this.root.getConstants("criteriaType"))),e("div",{id:"criteria-form"}),e("button",{class:"btn btn-outline-secondary",id:"remove-criteria",onClick:this.onRemoveCriteria},e("span",{class:"icon icon-minus"})))))}attributeChangedCallback(e){this.onChangeAttribute[e]()}onChangeAttribute={criteria:()=>this.changedCriteriaHandler()};onChangeCriteria=({target:e})=>{this.setAttribute("criteria",e.value)};changedCriteriaHandler=async()=>{const a=this.criteria?(await d(this.criteria))({root:this.root,form:this}):e(t,null);this.insertCriteriaForm(a)};insertCriteriaForm=t=>{this.criteriaFormElement.replaceWith(e("div",{id:"criteria-form"},t))};onRemoveCriteria=()=>{--this.root.sequentialId,this.remove()}}!customElements.get("criteria-form")&&customElements.define("criteria-form",l,{extends:"form"}),await import("@ui/table.js");const u=t=>t.inters.map((i=>{const o=t.criteriaNumber.reduce(((e,t,a)=>{let r=++a;return e[`C${r}`]=i.options.map((e=>++e)).includes(r)?"X":"",e}),{});return{externalId:i.externalId,data:()=>({fragments:e("a",{is:"nav-to",content:!0,to:a(i.xmlId)},i.fragTitle),interpretations:e("a",{is:"nav-to",content:!0,to:r(i.xmlId,i.urlId)},i.title),...o,sourceTypeHeader:i.sourceType,sourcesHeader:e("span",{"data-search-key":i.sources},t.getConstants(i.sources)),hasLdoDMarkHeader:i.hasLdoDMark?t.getConstants("yes"):t.getConstants("no"),dateHeader:i.date,editionHeader:i.editor,heteronymHeader:"não atribuído"===i.heteronym?t.getConstants(i.heteronym):i.heteronym}),search:JSON.stringify(Object.values(i).join(", "))}})),h=({root:t})=>{const a=["fragments","interpretations",...t.criteriaNumber.map((e=>"C"+ ++e)),"sourceTypeHeader","sourcesHeader","hasLdoDMarkHeader","editionHeader","heteronymHeader","dateHeader"];return e("ldod-table",{id:"search-advanced",classes:"table table-bordered table-hover",headers:a,data:u(t),constants:s(t.fragsNumber,t.intersNumber)[t.language],"data-searchkey":"externalId"})},m=Object.freeze(Object.defineProperty({__proto__:null,default:h},Symbol.toStringTag,{value:"Module"}));class p extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.constants=s,this.sequentialId=1,this.mode="and"}get language(){return this.getAttribute("language")}get resultTable(){return this.shadowRoot.querySelector("ldod-table#search-advanced")}static get observedAttributes(){return["language"]}getConstants(e){return s(this.fragsNumber,this.intersNumber)[this.language][e]}CriteriaForm=()=>e("form",{is:"criteria-form",root:this});fetchData=async()=>{i().then((e=>this.data=e)).catch((e=>console.error(e)))};async connectedCallback(){await this.fetchData(),this.shadowRoot.appendChild(e("style",null,o,"div#main{margin-top:50px;max-width:400px}div#options{display:flex;justify-content:space-between;gap:20px;flex-wrap:wrap}form[is=criteria-form] div#criteria-container,form[is=criteria-form] div#criteria-form{display:flex;gap:10px;flex-wrap:wrap}form[is=criteria-form] div#criteria-container{justify-content:space-between}.form-select{font-size:14px!important}span.icon{pointer-events:none}span.icon-minus{background:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 448 512'%3E%3Cpath d='M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z'/%3E%3C/svg%3E\") no-repeat center;background-size:15px}span.icon-plus,span.icon-plus:hover{background:var(--main-plus-url);background-size:15px}button{border:1px solid #ced4da!important}button#add-criteria{--main-plus-url: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 448 512'%3E%3Cpath d='M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z'/%3E%3C/svg%3E\") no-repeat center}button#add-criteria:hover{--main-plus-url: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 448 512'%3E%3Cpath fill='%23fff' d='M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z'/%3E%3C/svg%3E\") no-repeat center}button#remove-criteria{max-height:58px}div#actions{gap:\"10px\";display:flex;justify-content:space-between;margin-bottom:20px}div#date-wrapper{display:flex;flex-direction:column;gap:10px}div#wrapper{display:flex;gap:10px}table#search-advanced>thead th:nth-child(1),table#search-advanced>thead th:nth-child(2){text-align:start}table#search-advanced>tbody td{text-align:center}table#search-advanced>tbody td:nth-child(1),table#search-advanced>tbody td:nth-child(2){text-align:start}table#search-advanced>tbody>tr{cursor:cell}\n")),this.render()}render(){this.shadowRoot.appendChild(e(t,null,e("h3",{class:"text-center","data-search-key":"advancedSearch"},this.getConstants("advancedSearch")),e("div",{id:"main"},e("select",{class:"form-select",name:"mode",onChange:({target:e})=>this.mode=e.value},e("option",{value:"and","data-search-key":"criteriaAnd"},this.getConstants("criteriaAnd")),e("option",{value:"or","data-search-key":"criteriaOr"},this.getConstants("criteriaOr")))),e("div",{id:"criterias-container"},e(this.CriteriaForm,null)),e("hr",null),e("div",{id:"actions"},e("button",{class:"btn btn-outline-secondary",onClick:this.onSearch},e("span",{class:"icon icon-magnifying-glass"}),e("span",{"data-search-key":"search"},this.getConstants("search"))),e("button",{class:"btn btn-outline-secondary",id:"add-criteria",onClick:this.addCriteria},e("span",{class:"icon icon-plus"})))))}addCriteria=()=>{++this.sequentialId,this.shadowRoot.querySelector("#criterias-container").appendChild(e(this.CriteriaForm,null))};attributeChangedCallback(e,t,a){this.onChangeAttribute[e]()}onChangeAttribute={language:()=>this.onLanguage()};onLanguage=()=>{this.shadowRoot.querySelectorAll("[data-search-key]").forEach((e=>{e.firstChild.textContent=this.getConstants(e.dataset.searchKey)||e.dataset.searchKey}))};wrapDate=e=>{let t=e.begin,a=e.end,r=e.option;return delete(e={...e,date:{type:"date",option:r,begin:t,end:a}}).begin,delete e.end,delete e.option,e};wrapHeteronym=e=>{let t=e.heteronym;return delete e.heteronym,e={...e,heteronym:{type:"heteronym",heteronym:t}}};wrapDateAndHeteronymElements=e=>("date"===e.type||"heteronym"===e.type||(Object.keys(e).includes("option")&&(e=this.wrapDate(e)),Object.keys(e).includes("heteronym")&&(e=this.wrapHeteronym(e))),e);onSearch=async()=>{const e=Array.from(this.shadowRoot.querySelectorAll("form"));if(e.some((e=>!e.reportValidity())))return;let t=e.map((e=>this.wrapDateAndHeteronymElements(Object.fromEntries(new FormData(e)))));n({options:t,mode:this.mode}).then((e=>{this.inters=e,this.criteriaNumber=t.map(((e,t)=>t)),this.fragsNumber=new Set(e.map((e=>e.xmlId))).size,this.intersNumber=e.length,this.renderTableResult()})).catch((e=>console.log(e)))};renderTableResult=()=>{this.resultTable&&this.resultTable.remove(),this.shadowRoot.appendChild(e(h,{root:this}))};disconnectedCallback(){}}!customElements.get("ldod-search-adv")&&customElements.define("ldod-search-adv",p);const y=async(t,a)=>{document.querySelector(a).appendChild(e("ldod-search-adv",{language:t}))},g=()=>document.querySelector("ldod-search-adv")?.remove(),b="/advanced";export{y as mount,b as path,g as unMount};
//# sourceMappingURL=search-advanced-2f77ced2.js.map
