{"version":3,"file":"nav-dropdown.js","sources":["../../ldod-ui/nav-dropdown/nav-dropdown.js","../../ldod-ui/nav-dropdown/data-schema-validator.js"],"sourcesContent":["/** @format */\nimport { addLiItem, createDropdownRawHTML } from './nav-dropdown-html';\nimport { headerDataSchemaValidator } from './data-schema-validator';\n\nlet DropdownBS;\nconst loadDropdownJSModule = async () => {\n\tif (DropdownBS) return;\n\tDropdownBS = (await import('@ui/bootstrap/dropdown.js')).default;\n};\n\nexport class NavDropdown extends HTMLLIElement {\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\tget key() {\n\t\treturn this.getAttribute('key');\n\t}\n\n\tget language() {\n\t\treturn this.getAttribute('language');\n\t}\n\n\tget show() {\n\t\treturn this.hasAttribute('show');\n\t}\n\n\tget constants() {\n\t\treturn this.data.constants;\n\t}\n\n\tstatic get observedAttributes() {\n\t\treturn ['show', 'language', 'data-headers'];\n\t}\n\n\tattributeChangedCallback(name, oldValue, newValue) {\n\t\tthis.handleChangedAttribute[name](oldValue, newValue);\n\t}\n\thandleChangedAttribute = {\n\t\tshow: () => {\n\t\t\tthis.toggler.classList.toggle('show', this.show);\n\t\t\tthis.menu.classList.toggle('show', this.show);\n\t\t},\n\t\tlanguage: (oldValue, newValue) => {\n\t\t\tif (!this.data || !oldValue || oldValue === newValue) return;\n\t\t\tthis.querySelectorAll('[data-dropdown-key]').forEach(element => {\n\t\t\t\telement.textContent =\n\t\t\t\t\tthis.constants[this.language][element.dataset.dropdownKey] ||\n\t\t\t\t\telement.dataset.dropdownKey;\n\t\t\t});\n\t\t},\n\t\t'data-headers': (_, headersData) => {\n\t\t\tif (headersData) this.data = JSON.parse(headersData);\n\t\t\tthis.removeAttribute('data-headers');\n\t\t\tif (headerDataSchemaValidator(this.data)) this.render();\n\t\t},\n\t};\n\n\tconnectedCallback() {\n\t\tthis.render();\n\t}\n\n\trender = async () => {\n\t\tif (!this.data) return;\n\t\tthis.hidden = this.data.hidden;\n\t\tif (!this.innerHTML) this.innerHTML = createDropdownRawHTML(this.data, this.language);\n\t\tthis.toggler = this.querySelector('a.dropdown-toggle');\n\t\tthis.menu = this.querySelector('ul.dropdown-menu');\n\t\tthis.containerLinks = this.menu.querySelector('div.container-links');\n\t\tthis.addEventListeners();\n\t};\n\n\taddEventListeners = () => {\n\t\twindow.addEventListener('pointermove', this.loadDropdownModule, { once: true });\n\t\tthis.toggler.addEventListener('click', e => {\n\t\t\te.stopPropagation();\n\t\t\tthis.dispatchEvent(new PointerEvent('click', { bubbles: true, composed: true }));\n\t\t});\n\t};\n\n\tonNewLink = ({ payload }) => {\n\t\tif (!payload) return;\n\t\tconst { replace = false, name, data, constants } = payload;\n\t\tif (name !== this.key) return;\n\t\tthis.setConstants(constants);\n\n\t\tconst itemsHTML = /*html*/ `\n\t\t\t${data.links.reduce((html, page) => {\n\t\t\t\treturn html + addLiItem(page, this.language, this.constants);\n\t\t\t}, '')}\n\t\t`;\n\n\t\tif (replace) this.containerLinks.innerHTML = '';\n\t\tthis.containerLinks.insertAdjacentHTML('beforeend', itemsHTML);\n\t};\n\n\tloadDropdownModule = async () => {\n\t\tawait loadDropdownJSModule();\n\t\tthis.dropdown = new DropdownBS(this.querySelector('.dropdown-toggle'));\n\t};\n\n\tsetConstants(constants = {}) {\n\t\tObject.entries(constants).reduce((prev, [key, val]) => {\n\t\t\tprev[key] = { ...prev[key], ...val };\n\t\t\treturn prev;\n\t\t}, this.constants);\n\t}\n}\ncustomElements.define('nav-dropdown', NavDropdown, { extends: 'li' });\n","/** @format */\n\nimport headerSchema from './data-schema.json';\n\nexport const headerDataSchemaValidator = data => {\n\tif (!globalThis.validator) return;\n\tconst errors = validator.validate(data, headerSchema).errors;\n\tif (errors.length) {\n\t\terrors.forEach(error => console.error(error));\n\t\treturn false;\n\t}\n\treturn true;\n};\n"],"names":["DropdownBS","NavDropdown","HTMLLIElement","constructor","key","this","getAttribute","language","show","hasAttribute","constants","data","observedAttributes","attributeChangedCallback","name","oldValue","newValue","handleChangedAttribute","toggler","classList","toggle","menu","querySelectorAll","forEach","element","textContent","dataset","dropdownKey","_","headersData","JSON","parse","removeAttribute","globalThis","validator","errors","validate","headerSchema","length","error","console","headerDataSchemaValidator","render","connectedCallback","async","hidden","innerHTML","createDropdownRawHTML","querySelector","containerLinks","addEventListeners","window","addEventListener","loadDropdownModule","once","e","stopPropagation","dispatchEvent","PointerEvent","bubbles","composed","onNewLink","payload","replace","setConstants","itemsHTML","links","reduce","html","page","addLiItem","insertAdjacentHTML","import","default","loadDropdownJSModule","dropdown","Object","entries","prev","val","customElements","define","extends"],"mappings":"yDAIA,IAAIA,EAMG,MAAMC,UAAoBC,cAChCC,qBAEC,CAEGC,UACI,OAAAC,KAAKC,aAAa,MACzB,CAEGC,eACI,OAAAF,KAAKC,aAAa,WACzB,CAEGE,WACI,OAAAH,KAAKI,aAAa,OACzB,CAEGC,gBACH,OAAOL,KAAKM,KAAKD,SACjB,CAEUE,gCACH,MAAA,CAAC,OAAQ,WAAY,eAC5B,CAEDC,yBAAyBC,EAAMC,EAAUC,GACxCX,KAAKY,uBAAuBH,GAAMC,EAAUC,EAC5C,CACDC,uBAAyB,CACxBT,KAAM,KACLH,KAAKa,QAAQC,UAAUC,OAAO,OAAQf,KAAKG,MAC3CH,KAAKgB,KAAKF,UAAUC,OAAO,OAAQf,KAAKG,KAAI,EAE7CD,SAAU,CAACQ,EAAUC,MACfX,KAAKM,OAASI,GAAYA,IAAaC,GAC5CX,KAAKiB,iBAAiB,uBAAuBC,SAAQC,IACpDA,EAAQC,YACPpB,KAAKK,UAAUL,KAAKE,UAAUiB,EAAQE,QAAQC,cAC9CH,EAAQE,QAAQC,WAAA,GACjB,EAEF,eAAgB,CAACC,EAAGC,KACfA,IAAaxB,KAAKM,KAAOmB,KAAKC,MAAMF,IACxCxB,KAAK2B,gBAAgB,gBCjDiB,CAAArB,IACxC,IAAKsB,WAAWC,UAAW,OAC3B,MAAMC,EAASD,UAAUE,SAASzB,EAAM0B,GAAcF,OAClDA,OAAAA,EAAOG,SACVH,EAAOZ,SAAQgB,GAASC,QAAQD,MAAMA,MAC/B,EAED,ED2CDE,CAA0BpC,KAAKM,OAAON,KAAKqC,QAAM,GAIvDC,oBACCtC,KAAKqC,QACL,CAEDA,OAASE,UACHvC,KAAKM,OACVN,KAAKwC,OAASxC,KAAKM,KAAKkC,OACnBxC,KAAKyC,YAAWzC,KAAKyC,UAAYC,EAAsB1C,KAAKM,KAAMN,KAAKE,WAC5EF,KAAKa,QAAUb,KAAK2C,cAAc,qBAClC3C,KAAKgB,KAAOhB,KAAK2C,cAAc,oBAC/B3C,KAAK4C,eAAiB5C,KAAKgB,KAAK2B,cAAc,uBAC9C3C,KAAK6C,oBAAiB,EAGvBA,kBAAoB,KACnBC,OAAOC,iBAAiB,cAAe/C,KAAKgD,mBAAoB,CAAEC,MAAM,IACxEjD,KAAKa,QAAQkC,iBAAiB,SAASG,IACtCA,EAAEC,kBACFnD,KAAKoD,cAAc,IAAIC,aAAa,QAAS,CAAEC,SAAS,EAAMC,UAAU,IAAO,GAC/E,EAGFC,UAAY,EAAGC,QAAAA,MACd,IAAKA,EAAS,OACR,MAAEC,QAAAA,GAAU,EAAOjD,KAAAA,EAAMH,KAAAA,EAAMD,UAAAA,GAAcoD,EACnD,GAAIhD,IAAST,KAAKD,IAAK,OACvBC,KAAK2D,aAAatD,GAEZuD,MAAAA,EAAAA,WACHtD,EAAKuD,MAAMC,QAAO,CAACC,EAAMC,IACnBD,EAAOE,EAAUD,EAAMhE,KAAKE,SAAUF,KAAKK,YAChD,YAGAqD,IAAS1D,KAAK4C,eAAeH,UAAY,IAC7CzC,KAAK4C,eAAesB,mBAAmB,YAAaN,EAAS,EAG9DZ,mBAAqBT,eA3FOA,WACxB5C,IACJA,SAAoBwE,OAAO,8BAA8BC,QAAA,EA0FlDC,GACNrE,KAAKsE,SAAW,IAAI3E,EAAWK,KAAK2C,cAAc,oBAAmB,EAGtEgB,aAAatD,EAAY,IACjBkE,OAAAC,QAAQnE,GAAWyD,QAAO,CAACW,GAAO1E,EAAK2E,MAC7CD,EAAK1E,GAAO,IAAK0E,EAAK1E,MAAS2E,GACxBD,IACLzE,KAAKK,UACR,EAEFsE,eAAeC,OAAO,eAAgBhF,EAAa,CAAEiF,QAAS"}