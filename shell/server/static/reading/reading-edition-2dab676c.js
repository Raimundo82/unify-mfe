import{ldodEventPublisher as e,createElement as t,createFragment as n,navigateTo as r,htmlRender as i}from"@core";import{s as a,c as o,R as s,r as d,g as l}from"./reading-router-7a925504.js";import{r as c}from"./reading-f37a19ee.js";import"@ui/modal-bs.js";const h=window?.references?.text||{},u=(e,t)=>h.fragmentInter?.(e,t),m=()=>import("@ui/tooltip.js"),p=new CSSStyleSheet;p.replaceSync(a);class g extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.adoptedStyleSheets=[p],this.constants=o}get language(){return this.getAttribute("language")}get wrapper(){return this.shadowRoot.querySelector("#reading-edition-wrapper")}get recommendationModal(){return this.shadowRoot.querySelector("#reading-recommendation--modal")}static get observedAttributes(){return["language"]}getConstants(e){return this.constants[this.language][e]}connectedCallback(){this.shadowRoot.appendChild(t("div",{id:"reading-edition-wrapper"})),this.expertEditions&&this.render(),this.addEventListeners()}render(){this.wrapper.innerHTML="",this.wrapper.appendChild(t(n,null,t("div",{class:"reading-grid"},this.expertEditions.map(((e,a)=>{const o=e.transcript;return t(n,null,t("div",{class:o?"reading-column-open":"reading-column"},t("h4",null,t("a",{is:"nav-to",to:c.editionInterPath(e.xmlId,e.urlId)},e.editor)),e.editorialInters.map((e=>t("div",{key:e.externalId,class:"reading-inter"},t("h2",null,t("a",{is:"nav-to",to:c.editionInterPath(e.xmlId,e.urlId)},`${e.number}`)),t("div",{style:{display:"flex",flexWrap:"wrap"}},t("span",{is:"ldod-span-icon",icon:"arrow-left",fill:"black",size:"30px",class:"icon",onClick:()=>r(c.editionInterPath(e.prevXmlId,e.prevUrlId))}),t("span",{is:"ldod-span-icon",icon:"arrow-right",fill:"black",size:"30px",class:"icon",onClick:()=>r(c.editionInterPath(e.nextXmlId,e.nextUrlId))})))))),o&&t("div",{class:"reading-text",style:{gridColumn:`${a+2}/${a+9}`}},t("h1",null,t("a",{is:"nav-to",content:!0,to:u(e.xmlId,e.urlId)},e.transcriptTitle)),t("div",{class:"reading-transcript"},i(o))))})),t("div",{class:"reading-column"},t("span",{id:"reading-recommendation","data-reading-key":"recommendation",onClick:this.onRecommendation},this.getConstants("recommendation")),t("div",{class:"reading-inter-current"},t("a",{is:"nav-to",to:c.editionInterPath(this.currentInter.xmlId,this.currentInter.urlId)},t("h3",null,this.currentInter.acronym),t("h2",null,`${this.currentInter.number}`)),t("span",{id:"reading-recommendationTooltip",is:"ldod-span-icon",size:"30px",icon:"circle-info",class:"icon"})),this.prevInter&&t("div",{class:"reading-inter"},t("a",{is:"nav-to",to:c.editionInterPath(this.prevInter.xmlId,this.prevInter.urlId)},t("h3",null,this.prevInter.acronym),t("h2",null,`${this.prevInter.number}`)),t("span",{is:"ldod-span-icon",icon:"arrow-left",fill:"black",size:"30px",class:"icon",onClick:()=>r(c.editionInterPath(this.prevInter.xmlId,this.prevInter.urlId))})),this.recommendedInters.map((e=>t("div",{key:e.externalId,class:"reading-inter"},t("a",{is:"nav-to",to:c.editionInterPath(e.xmlId,e.urlId)},t("h3",null,e.acronym),t("h2",null,`${e.number}`)),t("span",{is:"ldod-span-icon",icon:"arrow-right",fill:"black",size:"30px",class:"icon",onClick:()=>r(c.editionInterPath(e.xmlId,e.urlId))})))))),t(s,{root:this})))}updateData(e){this.expertEditions=e.editions,this.recommendedInters=e.recommendedInters,this.currentInter=e.currentInter,this.prevInter=e.prevInter,d.setState((t=>({...t,read:e.read||t.read}))),this.render()}attributeChangedCallback(e,t,n){this.onChangeAttribute[e]()}onChangeAttribute={language:()=>this.onlanguageChange()};onlanguageChange=()=>{this.shadowRoot.querySelectorAll("[data-reading-key]").forEach((e=>{e.firstChild.textContent=this.getConstants(e.dataset.readingKey)})),this.shadowRoot.querySelectorAll("[data-reading-tooltip-key]").forEach((e=>{e.setAttribute("content",this.getConstants(e.dataset.readingTooltipKey))}))};onRecommendation=async()=>{this.recommendationModal.toggleAttribute("show",!0)};onRecommendationSubmit=()=>{this.recommendationModal.toggleAttribute("show"),r(c.editionInterPath(this.currentInter.xmlId,this.currentInter.urlId))};addEventListeners=()=>{this.wrapper.addEventListener("pointerenter",m)}}!customElements.get("ldod-reading-edition")&&customElements.define("ldod-reading-edition",g);const I=async(n,r)=>{const{xmlId:i,urlId:a}=history.state;l(i,a).then((e=>o.updateData(e))).catch((t=>(t=>e("error",t))(t?.message)));const o=document.querySelector(r).appendChild(t("ldod-reading-edition",{language:n}))},v=()=>document.querySelector("ldod-reading-edition")?.remove(),x="/fragment/:xmlId/inter/:urlId";export{I as mount,x as path,v as unMount};
//# sourceMappingURL=reading-edition-2dab676c.js.map
