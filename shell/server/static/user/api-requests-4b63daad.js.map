{"version":3,"file":"api-requests-4b63daad.js","sources":["../src/api-requests.js"],"sourcesContent":["/** @format */\n// Include the typedefs file\n/// <reference path=\"typedef.js\" />\n\nimport { fetcher, navigateTo } from '@core';\nimport { getState } from './store';\nimport { errorPublisher } from './events-modules';\nimport { userReferences } from './user-references.js';\n\nexport const signinRequest = async data => await fetcher.post(`/auth/sign-in`, data);\n\nexport async function userRequest(token) {\n\treturn await fetcher.get(`/user`, null, token).then(res => {\n\t\tif (!res || res.ok === false) return Promise.reject(res);\n\t\treturn Promise.resolve(res);\n\t});\n}\n\nexport const signupRequest = async data => await fetcher.post(`/auth/sign-up`, data);\n\nexport const socialAuthRequest = async (path, data, loginCB) =>\n\tfetcher\n\t\t.post(`/auth/${path}`, data)\n\t\t.then(response => {\n\t\t\tif (isFormState(response)) {\n\t\t\t\tnavigateTo(userReferences.signup(), response);\n\t\t\t\treturn Promise.resolve({ message: 'googleAssociation' });\n\t\t\t}\n\t\t\tisAccessToken(response) && loginCB(response.accessToken);\n\t\t})\n\t\t.catch(e => console.error(e));\n\nexport const tokenConfirmRequest = async path => await fetcher.get(`/auth${path}`, null);\n\nexport const tokenAuthRequest = async path => {\n\tif (import.meta.env.PROD && !getState().token) {\n\t\terrorPublisher('Not authorized to access resource');\n\t\treturn navigateTo('/');\n\t}\n\treturn await fetcher.get(`/admin/user${path}`, null, getState().token);\n};\n\nexport const changePasswordRequest = async data =>\n\tfetcher.post(`/user/change-password`, data, getState().token);\n\n/**\n *\n * @returns {Promise<?Array<User>>}\n */\nexport const getUsersList = async () => {\n\tif (!getState().token) {\n\t\terrorPublisher('Not authorized to access resource');\n\t\treturn navigateTo('/');\n\t}\n\treturn await fetcher.get(`/admin/user/list`, null, getState().token);\n};\n\nexport const switchModeRequest = async () =>\n\tawait fetcher.post(`/admin/user/switch`, null, getState().token);\n\nexport const deleteSessionsRequest = async () =>\n\tawait fetcher.post(`/admin/user/sessions-delete`, null, getState().token);\n\nexport const changeActiveRequest = async externalId =>\n\tawait fetcher.post(`/admin/user/active/${externalId}`);\n\nexport const removeUserRequest = async externalId =>\n\tawait fetcher.post(`/admin/user/delete/${externalId}`);\n\nexport const updateUserRequest = async data =>\n\tawait fetcher\n\t\t.post(`/admin/user/edit`, data)\n\t\t.then(requestInterceptorMiddleware)\n\t\t.catch(console.error);\n\nfunction isAccessToken(response) {\n\treturn Object.keys(response).some(key => key === 'accessToken' || key === 'tokenType');\n}\n\nfunction isFormState(object) {\n\treturn object && 'socialId' in object;\n}\n\nfunction requestInterceptorMiddleware(response) {\n\treturn new Promise((resolve, reject) => {\n\t\tif (response.ok === 'false') {\n\t\t\tconst message = response.message;\n\t\t\terrorPublisher(message);\n\t\t\treturn reject(message);\n\t\t}\n\t\treturn resolve(response);\n\t});\n}\n"],"names":["signinRequest","async","data","fetcher","post","userRequest","token","get","then","res","ok","Promise","resolve","reject","signupRequest","socialAuthRequest","path","loginCB","response","object","isFormState","navigateTo","userReferences","signup","message","Object","keys","some","key","isAccessToken","accessToken","catch","e","console","error","tokenConfirmRequest","tokenAuthRequest","getState","errorPublisher","changePasswordRequest","getUsersList","switchModeRequest","deleteSessionsRequest","changeActiveRequest","externalId","removeUserRequest","updateUserRequest","requestInterceptorMiddleware"],"mappings":"+MASY,MAACA,EAAgBC,MAAMC,SAAcC,EAAQC,KAAK,gBAAiBF,GAExED,eAAeI,EAAYC,GAC1B,aAAMH,EAAQI,IAAI,QAAS,KAAMD,GAAOE,MAAKC,GAC9CA,IAAkB,IAAXA,EAAIC,GACTC,QAAQC,QAAQH,GADcE,QAAQE,OAAOJ,IAGtD,CAEY,MAACK,EAAgBb,MAAMC,SAAcC,EAAQC,KAAK,gBAAiBF,GAElEa,EAAoBd,MAAOe,EAAMd,EAAMe,IACnDd,EACEC,KAAK,SAASY,IAAQd,GACtBM,MAAKU,IACL,GAuDH,SAAqBC,GACpB,OAAOA,GAAU,aAAcA,CAChC,CAzDOC,CAAYF,GACfG,OAAAA,EAAWC,EAAeC,SAAUL,GAC7BP,QAAQC,QAAQ,CAAEY,QAAS,uBAiDtC,SAAuBN,GACf,OAAAO,OAAOC,KAAKR,GAAUS,MAAKC,GAAe,gBAARA,GAAiC,cAARA,GACnE,EAjDGC,CAAcX,IAAaD,EAAQC,EAASY,YAAW,IAEvDC,OAAMC,GAAKC,QAAQC,MAAMF,KAEfG,EAAsBlC,MAAMe,SAAcb,EAAQI,IAAI,QAAQS,IAAQ,MAEtEoB,EAAmBnC,MAAMe,GACRqB,IAAW/B,YAI3BH,EAAQI,IAAI,cAAcS,IAAQ,KAAMqB,IAAW/B,QAH/DgC,EAAe,qCACRjB,EAAW,MAKPkB,EAAwBtC,MAAMC,GAC1CC,EAAQC,KAAK,wBAAyBF,EAAMmC,IAAW/B,OAM3CkC,EAAevC,SACtBoC,IAAW/B,YAIHH,EAAQI,IAAI,mBAAoB,KAAM8B,IAAW/B,QAH7DgC,EAAe,qCACRjB,EAAW,MAKPoB,EAAoBxC,eAC1BE,EAAQC,KAAK,qBAAsB,KAAMiC,IAAW/B,OAE9CoC,EAAwBzC,eAC9BE,EAAQC,KAAK,8BAA+B,KAAMiC,IAAW/B,OAEvDqC,EAAsB1C,MAAM2C,SAClCzC,EAAQC,KAAK,sBAAsBwC,KAE7BC,EAAoB5C,MAAM2C,SAChCzC,EAAQC,KAAK,sBAAsBwC,KAE7BE,EAAoB7C,MAAMC,SAChCC,EACJC,KAAK,mBAAoBF,GACzBM,KAAKuC,GACLhB,MAAME,QAAQC,OAUjB,SAASa,EAA6B7B,GACrC,OAAO,IAAIP,SAAQ,CAACC,EAASC,KACxBK,GAAgB,UAAhBA,EAASR,GAAgB,CAC5B,MAAMc,EAAUN,EAASM,QACzB,OAAAc,EAAed,GACRX,EAAOW,EAAO,CAEtB,OAAOZ,EAAQM,EAAQ,GAEzB"}