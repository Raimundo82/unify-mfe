{"version":3,"file":"shell.js","sources":["../src/sw/service-worker-reg.js","../src/body-observer.js","../src/shell-store.js","../src/events-module.js","../src/components/not-found.js","../src/shell-router.js","../src/worker-loader.js","../src/shell.js"],"sourcesContent":["/** @format */\n\nif (navigator.serviceWorker) register();\n\nasync function register() {\n\tconst reg = await navigator.serviceWorker\n\t\t.register('/ldod-mfes/service-worker.js', {\n\t\t\tscope: '/ldod-mfes/',\n\t\t\tupdateViaCache: 'none',\n\t\t})\n\t\t.catch(error => console.error(error));\n\tif (reg?.installing) console.log('Service worker installing');\n\tif (reg?.waiting) console.log('Service worker installed');\n\tif (reg?.active) console.log('Service worker active');\n}\n\nnavigator.serviceWorker.addEventListener('message', event => {\n\tconsole.log('Main thread received a message:', event.data);\n\tlocation.reload();\n});\n","/** @format */\n\nconst observable = document.body;\n\ncustomElements.whenDefined('nav-bar').then(({ instance }) => {\n\tif (!(instance instanceof HTMLElement)) return;\n\tconst navElement = instance.shadowRoot.firstElementChild;\n\tnew MutationObserver(mutations => {\n\t\tmutations.forEach(mutation => {\n\t\t\tif (observable.scrollHeight <= window.innerHeight) return;\n\t\t\tif (mutation.target.classList.contains('modal-open')) {\n\t\t\t\tnavElement.style.paddingRight = '15px';\n\t\t\t\tobservable.style.paddingRight = '15px';\n\t\t\t} else {\n\t\t\t\tnavElement.style.paddingRight = '0px';\n\t\t\t\tobservable.style.paddingRight = '0px';\n\t\t\t}\n\t\t});\n\t}).observe(observable, {\n\t\tattributes: true,\n\t\tattributeFilter: ['class'],\n\t});\n});\n","/** @format */\n\nimport { Store } from '@core';\n\nexport const store = new Store(\n\t{ language: 'en', token: '' },\n\t{ storageName: 'ldod-store', keys: ['language', 'token'] }\n);\nstore.subscribe(updateLanguage);\n\nsetLanguage();\n\nexport function getLanguage() {\n\treturn store.getState().language;\n}\n\nfunction updateLanguage(newState, currentState) {\n\tif (newState.language !== currentState.language) setLanguage();\n}\n\nexport function setLanguage() {\n\tdocument.body\n\t\t.querySelectorAll('[language]')\n\t\t.forEach(ele => ele.setAttribute('language', getLanguage()));\n}\n","/** @format */\n\nimport { ldodEventSubscriber, ldodEventPublisher } from '@core';\nimport { getLanguage, store } from './shell-store.js';\nlet notification;\n\nconst loadNotification = async () => {\n\tnotification = (await import('./components/notification.js')).default;\n};\n\nconst notificationContainer = document.getElementById('notification-container');\n\nasync function notifications(content, theme) {\n\tif (!notification) await loadNotification();\n\tnotificationContainer.appendChild(notification(content, theme));\n}\n\nconst handlers = {\n\ttoken: ({ payload }) => store.setState({ token: payload }),\n\tlanguage: ({ payload }) => store.setState({ language: payload || 'en' }),\n\terror: ({ payload }) => notifications(payload || 'Something went wrong', 'danger'),\n\tmessage: ({ payload }) => notifications(payload || '', 'success'),\n};\n\nldodEventSubscriber('language', handlers.language);\nldodEventSubscriber('token', handlers.token);\nldodEventSubscriber('logout', handlers.token);\nldodEventSubscriber('message', handlers.message);\nldodEventSubscriber('error', handlers.error);\nldodEventPublisher('language', getLanguage());\n","/** @format */\n\nimport { ldodEventSubscriber } from '@core';\n\nconst message = {\n\tpt: 'LdoD: Esta página não existe...',\n\ten: 'LdoD: Page not found...',\n\tes: 'LdoD: Esta página no existe',\n};\n\nconst getNoPage = () => document.body.querySelector('div#no-page.container');\n\nconst NoPage = language =>\n\t/*html*/ `<div id=\"no-page\" class=\"container\">${message[language]}</div>`;\n\nlet langUnsub;\n\nconst mount = (language, ref) => {\n\tconst container = document.body.querySelector(ref);\n\tcontainer.innerHTML = NoPage(language);\n\tlangUnsub = ldodEventSubscriber('language', handleLanguageEvent);\n};\nconst unMount = () => {\n\tlangUnsub();\n\tgetNoPage().remove();\n};\n\nconst handleLanguageEvent = ({ payload }) => (getNoPage().textContent = message[payload]);\n\nexport default () => ({\n\tpath: '/not-found',\n\tmount,\n\tunMount,\n});\n","/** @format */\n\nimport notFound from './components/not-found';\nimport { getLanguage } from './shell-store';\n\nconst modules = JSON.parse(document.querySelector('script#importmap').textContent).imports;\nconst router = document.body.querySelector('ldod-router');\nrouter.setAttribute('language', getLanguage());\nrouter.fallback = notFound;\n\nconst routes = await Object.keys(modules)\n\t.filter(mod => !mod.startsWith('@'))\n\t.reduce(async (prev, mfeName) => {\n\t\tawait import(mfeName)\n\t\t\t.then(async mod => {\n\t\t\t\tconst api = mod.default;\n\t\t\t\tconst mfePath = api.path;\n\n\t\t\t\tif (mfePath === '/') router.index = () => api;\n\t\t\t\telse if (mfePath) (await prev)[mfePath] = () => api;\n\t\t\t})\n\t\t\t.catch(e => console.error(e));\n\t\treturn await prev;\n\t}, Promise.resolve({}));\n\nrouter.processRoutes(routes);\n","/** @format */\n\nconst worker = new Worker('/ldod-mfes/shell/worker.js', { type: 'module' });\n\nconst FONTS_URL = '/ldod-mfes/shell/style/fonts';\nconst ROOT_CSS_URL = '/ldod-mfes/shared/ui/bootstrap/root.css';\nconst fonts = [\n\t{\n\t\tfamily: 'Work-Sans',\n\t\tsrc: `${FONTS_URL}/WorkSans-VariableFont_wght.ttf`,\n\t\tstyle: 'normal',\n\t\tweight: '200 800',\n\t\tdisplay: 'optional',\n\t},\n\n\t{\n\t\tfamily: 'Space-Mono',\n\t\tsrc: `${FONTS_URL}/space-mono/SpaceMono-Bold.ttf`,\n\t\tstyle: 'normal',\n\t\tweight: 700,\n\t\tdisplay: 'swap',\n\t},\n\t{\n\t\tfamily: 'Ultra',\n\t\tsrc: `${FONTS_URL}/ultra/Ultra-Regular.ttf`,\n\t\tstyle: 'normal',\n\t\tweight: 400,\n\t\tdisplay: 'swap',\n\t},\n\t{\n\t\tfamily: 'League-Gothic',\n\t\tsrc: `${FONTS_URL}/league-gothic/LeagueGothic-Regular.otf`,\n\t\tstyle: 'normal',\n\t\tweight: 400,\n\t\tdisplay: 'swap',\n\t},\n\t{\n\t\tfamily: 'League-Gothic-Condensed',\n\t\tsrc: `${FONTS_URL}/league-gothic/LeagueGothic-CondensedRegular.otf`,\n\t\tstyle: 'normal',\n\t\tweight: 400,\n\t\tdisplay: 'swap',\n\t},\n\n\t{\n\t\tfamily: 'Space-Mono',\n\t\tsrc: `${FONTS_URL}/space-mono/SpaceMono-Regular.ttf`,\n\t\tstyle: 'normal',\n\t\tweight: 400,\n\t\tdisplay: 'swap',\n\t},\n];\n\nfonts.forEach(font => {\n\tworker.postMessage({ type: 'font', url: font.src });\n});\nworker.postMessage({ type: 'css', url: ROOT_CSS_URL });\n\n//worker.postMessage({ type: 'script', url: '/ldod-mfes/shared/notifications.js' });\n//worker.postMessage({ type: 'script', url: '/ldod-mfes/shared/ldod-icons.js' });\n//worker.postMessage({ type: 'script', url: '/ldod-mfes/references.js' });\n\nconst workerHandler = {\n\tfont: (res, url) => onFont(res, url),\n\tcss: (res, url) => onCss(res),\n\tscript: (res, url) => onScript(res),\n};\n\nworker.onmessage = ({ data: { type, url, res } }) => workerHandler[type](res, url);\n\nfunction onFont(res, url) {\n\tconst { family, display, style, weight } = fonts.find(font => font.src === url);\n\tdocument.fonts.add(\n\t\tnew FontFace(family, res, {\n\t\t\tstyle,\n\t\t\tweight,\n\t\t\tdisplay,\n\t\t})\n\t);\n}\nfunction onCss(res) {\n\tconst style = document.createElement('style');\n\tstyle.innerHTML = new TextDecoder().decode(res);\n\tdocument.head.appendChild(style);\n}\n\nfunction onScript(res) {\n\tconst script = document.createElement('script');\n\tscript.type = 'module';\n\tscript.innerHTML = new TextDecoder().decode(res);\n\tdocument.body.appendChild(script);\n}\n","/** @format */\n\nimport './sw/service-worker-reg';\nimport './body-observer.js';\nimport '@core';\nimport './events-module.js';\nimport './shell-router.js';\nimport './worker-loader.js';\n\nconst loadCoreUi = () => import('@core-ui');\nglobalThis?.addEventListener('pointermove', loadCoreUi, { once: true });\n"],"names":["navigator","serviceWorker","async","reg","register","scope","updateViaCache","catch","error","console","installing","log","waiting","active","addEventListener","event","data","location","reload","observable","document","body","customElements","whenDefined","then","instance","HTMLElement","navElement","shadowRoot","firstElementChild","MutationObserver","mutations","forEach","mutation","scrollHeight","window","innerHeight","target","classList","contains","style","paddingRight","observe","attributes","attributeFilter","store","Store","language","token","storageName","keys","getLanguage","getState","setLanguage","querySelectorAll","ele","setAttribute","notification","subscribe","newState","currentState","notificationContainer","getElementById","notifications","content","theme","import","default","loadNotification","appendChild","handlers","payload","setState","ldodEventSubscriber","ldodEventPublisher","message","pt","en","es","getNoPage","querySelector","langUnsub","mount","ref","innerHTML","NoPage","handleLanguageEvent","unMount","remove","textContent","modules","JSON","parse","imports","router","fallback","path","routes","Object","filter","mod","startsWith","reduce","prev","mfeName","api","mfePath","index","e","Promise","resolve","processRoutes","worker","Worker","type","FONTS_URL","fonts","family","src","weight","display","font","postMessage","url","workerHandler","res","find","add","FontFace","onFont","css","createElement","TextDecoder","decode","head","onCss","script","onScript","onmessage","globalThis","once"],"mappings":"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"}