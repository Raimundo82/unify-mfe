{"version":3,"file":"virtual-edition-7f198ddd.js","sources":["../src/pages/edition/virtual-edition/virtual-edition-component.jsx","../src/pages/edition/virtual-edition/ldod-virtual-edition.jsx","../src/pages/edition/virtual-edition/virtual-edition.js"],"sourcesContent":["/** @format */\n\nimport references from '@src/references';\nimport { textFragmentInter } from '../../../external-deps';\n\nimport.meta.env.DEV ? await import('@ui/table-dev.js') : await import('@ui/table.js');\n\nexport default ({ node }) => {\n\treturn (\n\t\t<div>\n\t\t\t<h3 class=\"text-center\">\n\t\t\t\t<span data-virtual-key=\"virtualEdition\">{node.getConstants('virtualEdition')}</span>\n\t\t\t\t: <span>{node.title}</span>\n\t\t\t</h3>\n\t\t\t<div id=\"virtualEditionInfo\">\n\t\t\t\t<p id=\"editors\">\n\t\t\t\t\t<strong data-virtual-key=\"editors\">{node.getConstants('editors')}</strong>\n\t\t\t\t\t<span>: </span>\n\t\t\t\t\t{node.participants.map((editor, index) => (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\tis=\"nav-to\"\n\t\t\t\t\t\t\t\tto={references.user(\n\t\t\t\t\t\t\t\t\teditor.username\n\t\t\t\t\t\t\t\t)}>{`${editor.firstname} ${editor.lastname}`}</a>\n\t\t\t\t\t\t\t{index === node.participants.length - 1 ? '' : ', '}\n\t\t\t\t\t\t</>\n\t\t\t\t\t))}\n\t\t\t\t</p>\n\t\t\t\t<p id=\"synopse\">\n\t\t\t\t\t<strong data-virtual-key=\"synopse\">{node.getConstants('synopse')}</strong>\n\t\t\t\t\t<span>: </span>\n\t\t\t\t\t{node.virtualEdition?.synopsis}\n\t\t\t\t</p>\n\t\t\t\t<p id=\"taxonomy\">\n\t\t\t\t\t<strong data-virtual-key=\"taxonomy\">{node.getConstants('taxonomy')}</strong>\n\t\t\t\t\t<span>: </span>\n\t\t\t\t\t<a is=\"nav-to\" to={references.taxonomy(node.virtualEdition?.acronym)}>\n\t\t\t\t\t\t{node.virtualEdition?.title}\n\t\t\t\t\t</a>\n\t\t\t\t</p>\n\t\t\t\t<p id=\"fragments\">\n\t\t\t\t\t<strong>{node.virtualEdition?.virtualEditionInters.length} </strong>\n\t\t\t\t\t<strong data-virtual-key=\"fragments\">{node.getConstants('fragments')}</strong>\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t\t<ldod-table\n\t\t\t\tid=\"virtual-virtualEditionTable\"\n\t\t\t\tclasses=\"table table-bordered table-hover\"\n\t\t\t\theaders={node.constants.veHeaders}\n\t\t\t\tdata={node.virtualEdition.virtualEditionInters.map(inter => {\n\t\t\t\t\tconst frag = inter.usedList[0];\n\t\t\t\t\treturn {\n\t\t\t\t\t\texternalId: inter.externalId,\n\t\t\t\t\t\tdata: () => ({\n\t\t\t\t\t\t\tnumber: inter.number,\n\t\t\t\t\t\t\ttitle: (\n\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\tis=\"nav-to\"\n\t\t\t\t\t\t\t\t\tcontent\n\t\t\t\t\t\t\t\t\tto={textFragmentInter(inter.xmlId, inter.urlId)}>\n\t\t\t\t\t\t\t\t\t{inter.title}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tcategory: inter.categories.map((cat, i) => (\n\t\t\t\t\t\t\t\t<div key={crypto.randomUUID()}>\n\t\t\t\t\t\t\t\t\t<a is=\"nav-to\" to={references.category(inter.shortName, cat)}>\n\t\t\t\t\t\t\t\t\t\t{cat}\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)),\n\t\t\t\t\t\t\tuseEdition: (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<span>{'-> '}</span>\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\tis=\"nav-to\"\n\t\t\t\t\t\t\t\t\t\tcontent\n\t\t\t\t\t\t\t\t\t\tto={textFragmentInter(frag.xmlId, frag.urlId)}>\n\t\t\t\t\t\t\t\t\t\t{frag.shortName}\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tsearch: JSON.stringify(inter),\n\t\t\t\t\t};\n\t\t\t\t})}\n\t\t\t\tconstants={node.constants}\n\t\t\t\tlanguage={node.language}\n\t\t\t\tdata-searchkey=\"externalId\"></ldod-table>\n\t\t</div>\n\t);\n};\n","/** @format */\n\nimport thisConstants from '../constants';\nimport constants from '../../constants';\nimport VirtualEditionComponent from './virtual-edition-component';\nimport style from '../ve-style.css?inline';\nimport { getVirtualEditionByAcronym } from '../api-requests';\n\nexport class LdodVirtualEdition extends HTMLElement {\n\tconstructor(lang) {\n\t\tsuper();\n\t\tthis.language = lang;\n\t\tthis.constants = Object.entries(thisConstants).reduce((prev, [key, value]) => {\n\t\t\tprev[key] = value instanceof Array ? value : { ...constants[key], ...value };\n\t\t\treturn prev;\n\t\t}, {});\n\t}\n\n\tset language(lang) {\n\t\tthis.setAttribute('language', lang);\n\t}\n\n\tget language() {\n\t\treturn this.getAttribute('language');\n\t}\n\n\tstatic get observedAttributes() {\n\t\treturn ['language'];\n\t}\n\n\tget title() {\n\t\treturn this.virtualEdition?.title;\n\t}\n\tget participants() {\n\t\treturn this.virtualEdition?.participants;\n\t}\n\n\tfetchData = async () => {\n\t\tawait getVirtualEditionByAcronym(history.state?.acrn)\n\t\t\t.then(data => (this.virtualEdition = data))\n\t\t\t.catch(error => console.error(error));\n\t};\n\n\tgetConstants = key => this.constants[this.language][key];\n\n\tasync connectedCallback() {\n\t\tawait this.fetchData();\n\t\tthis.render();\n\t}\n\n\trender = () => {\n\t\tthis.appendChild(<style>{style}</style>);\n\t\tthis.appendChild(<VirtualEditionComponent node={this} />);\n\t};\n\n\tattributeChangedCallback(name, oldV, newV) {\n\t\tthis.onChangeAttribute[name](oldV, newV);\n\t}\n\n\tonChangeAttribute = {\n\t\tlanguage: (oldV, newV) => oldV && oldV !== newV && this.handleChangeLanguage(),\n\t};\n\n\thandleChangeLanguage = () => {\n\t\tthis.querySelectorAll('[data-virtual-key]').forEach(ele => {\n\t\t\tele.firstChild.textContent = this.getConstants(ele.dataset.virtualKey);\n\t\t});\n\t};\n}\n!customElements.get('ldod-virtual-edition') &&\n\tcustomElements.define('ldod-virtual-edition', LdodVirtualEdition);\n","import { LdodVirtualEdition } from './ldod-virtual-edition';\n\nconst mount = async (lang, ref) => {\n  document.querySelector(ref).appendChild(new LdodVirtualEdition(lang));\n};\n\nconst unMount = () => document.querySelector('ldod-virtual-edition')?.remove();\n\nconst path = '/acronym/:acrn';\n\nexport { mount, unMount, path };\n"],"names":["import","VirtualEditionComponent","node","createElement","class","getConstants","title","id","participants","map","editor","index","createFragment","is","to","references","user","username","firstname","lastname","length","virtualEdition","synopsis","taxonomy","acronym","virtualEditionInters","classes","headers","constants","veHeaders","data","inter","frag","usedList","externalId","number","content","textFragmentInter","xmlId","urlId","category","categories","cat","i","key","crypto","randomUUID","shortName","useEdition","search","JSON","stringify","language","LdodVirtualEdition","HTMLElement","constructor","lang","super","this","Object","entries","thisConstants","reduce","prev","value","Array","setAttribute","getAttribute","observedAttributes","fetchData","async","getVirtualEditionByAcronym","history","state","acrn","then","catch","error","console","render","appendChild","style","attributeChangedCallback","name","oldV","newV","onChangeAttribute","handleChangeLanguage","querySelectorAll","forEach","ele","firstChild","textContent","dataset","virtualKey","customElements","get","define","mount","ref","document","querySelector","unMount","remove","path"],"mappings":"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"}