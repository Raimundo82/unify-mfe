{"version":3,"file":"ldod-ve-editors-d5eeed0c.js","sources":["../src/pages/virtual-editions/pages/index/components/editors/constants.js","../src/pages/virtual-editions/pages/index/components/editors/members-table.jsx","../src/pages/virtual-editions/pages/index/components/editors/pendent-table.jsx","../src/pages/virtual-editions/pages/index/components/editors/ldod-ve-editors.jsx"],"sourcesContent":["/** @format */\n\nexport default {\n\tmembersHeaders: ['username', 'firstname', 'lastname', 'email', 'role', 'remove'],\n\tpendentHeaders: ['username', 'firstname', 'lastname', 'email', 'add'],\n\tpt: {\n\t\taddMember: 'Adicionar membro',\n\t\tusername: 'Nome de utilizador',\n\t\tfirstname: 'Primeiro nome',\n\t\tlastname: 'Apelido',\n\t\temail: 'e-mail',\n\t\trole: 'Papel',\n\t\tadmin: 'Gestor',\n\t\tmember: 'Editor',\n\t\tremove: 'Remover',\n\t\tadd: 'Adicionar',\n\t\tpendingRequests: 'Pedidos de adesão',\n\t\teditionMembers: 'Membros da Edição',\n\t\teditors: 'Editores',\n\t},\n\ten: {\n\t\taddMember: 'Add member',\n\t\tusername: 'Username',\n\t\tfirstname: 'First name',\n\t\tlastname: 'Surname',\n\t\temail: 'e-mail',\n\t\trole: 'Role',\n\t\tadmin: 'Manager',\n\t\tmember: 'Editor',\n\t\tremove: 'Remove',\n\t\tadd: 'Add',\n\t\tpendingRequests: 'Membership applications',\n\t\teditionMembers: 'Edition Members',\n\t\teditors: 'Editors',\n\t},\n\tes: {\n\t\taddMember: 'Añadir miembro',\n\t\tusername: 'Nome de utilizador',\n\t\tfirstname: 'Primeiro nome',\n\t\tlastname: 'Apelido',\n\t\temail: 'e-mail',\n\t\trole: 'Papel',\n\t\tadmin: 'Gestor',\n\t\tmember: 'Editor',\n\t\tremove: 'Remover',\n\t\tadd: 'Adicionar',\n\t\tpendingRequests: 'Solicitud de Adhesión ',\n\t\teditionMembers: 'Miembros de la Edicíon ',\n\t\teditors: 'Editores',\n\t},\n};\n","/** @format */\n\nimport { switchMemberRole, removeParticipant } from '@src/restricted-api-requests';\nimport references from '@src/references';\nimport constants from './constants';\nconst isAdmin = node => node.edition?.member?.admin;\n\nconst onSwitchRole = async (node, username) => {\n\tnode.edition = await switchMemberRole(node.edition.externalId, username);\n\tnode.toggleAttribute('data');\n};\n\nconst onRemove = async (node, username) => {\n\tnode.edition = await removeParticipant(node.edition.externalId, username);\n\tnode.toggleAttribute('data');\n};\n\nconst getTableData = node => {\n\treturn node.edition.participants\n\t\t.filter(({ active }) => active)\n\t\t.map(participant => {\n\t\t\treturn {\n\t\t\t\texternalId: participant.externalId,\n\t\t\t\tusername: (\n\t\t\t\t\t<a is=\"nav-to\" to={references.user(participant.username)}>\n\t\t\t\t\t\t{participant.username}\n\t\t\t\t\t</a>\n\t\t\t\t),\n\t\t\t\tfirstname: participant.firstname,\n\t\t\t\tlastname: participant.lastname,\n\t\t\t\temail: participant.email,\n\t\t\t\trole:\n\t\t\t\t\tisAdmin(node) && participant.canSwitchRole ? (\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"btn btn-primary btn-sm\"\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tonClick={() => onSwitchRole(node, participant.username)}>\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tis=\"ldod-span-icon\"\n\t\t\t\t\t\t\t\ticon=\"rotate\"\n\t\t\t\t\t\t\t\tfill=\"#fff\"\n\t\t\t\t\t\t\t\tsize=\"14px\"\n\t\t\t\t\t\t\t\tstyle={{ marginRight: '8px' }}></span>\n\t\t\t\t\t\t\t{node.getConstants(participant.admin ? 'admin' : 'member')}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t) : (\n\t\t\t\t\t\tnode.getConstants(participant.admin ? 'admin' : 'member')\n\t\t\t\t\t),\n\t\t\t\tremove: participant.canBeRemoved && (\n\t\t\t\t\t<div class=\"center-container\">\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"icon-size icon-minus\"\n\t\t\t\t\t\t\tonClick={() => onRemove(node, participant.username)}></span>\n\t\t\t\t\t</div>\n\t\t\t\t),\n\n\t\t\t\tsearch: JSON.stringify(participant),\n\t\t\t};\n\t\t});\n};\n\nexport default ({ node }) => {\n\treturn (\n\t\t<ldod-table\n\t\t\tlanguage={node.language}\n\t\t\tid=\"virtual-veMembers\"\n\t\t\tclasses=\"table  table-hover\"\n\t\t\theaders={constants.membersHeaders}\n\t\t\tdata={getTableData(node)}\n\t\t\tconstants={constants}\n\t\t\tdata-searchkey=\"externalId\"></ldod-table>\n\t);\n};\n","/** @format */\n\nimport { approveParticipant } from '@src/restricted-api-requests';\nimport references from '@src/references';\nimport constants from './constants';\nconst isAdmin = node => node.edition?.member?.admin;\n\nconst onAddParticipant = async (node, username) => {\n\tnode.edition = await approveParticipant(node.edition.externalId, username);\n\tnode.toggleAttribute('data', true);\n};\n\nconst getTableData = node => {\n\treturn node.edition.participants\n\t\t.filter(({ pending }) => pending)\n\t\t.map(participant => {\n\t\t\treturn {\n\t\t\t\texternalId: participant.externalId,\n\t\t\t\tusername: (\n\t\t\t\t\t<a is=\"nav-to\" to={references.user(participant.username)}>\n\t\t\t\t\t\t{participant.username}\n\t\t\t\t\t</a>\n\t\t\t\t),\n\t\t\t\tfirstname: participant.firstname,\n\t\t\t\tlastname: participant.lastname,\n\t\t\t\temail: participant.email,\n\n\t\t\t\tadd: isAdmin(node) && (\n\t\t\t\t\t<div class=\"center-container\">\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"icon-size icon-add\"\n\t\t\t\t\t\t\tonClick={() => onAddParticipant(node, participant.username)}></span>\n\t\t\t\t\t</div>\n\t\t\t\t),\n\n\t\t\t\tsearch: JSON.stringify(participant),\n\t\t\t};\n\t\t});\n};\n\nexport default ({ node }) => {\n\treturn (\n\t\t<ldod-table\n\t\t\tlanguage={node.language}\n\t\t\tid=\"virtual-vePendents\"\n\t\t\tclasses=\"table table-hover\"\n\t\t\theaders={constants.pendentHeaders}\n\t\t\tdata={getTableData(node)}\n\t\t\tconstants={constants}\n\t\t\tdata-searchkey=\"externalId\"></ldod-table>\n\t);\n};\n","/** @format */\n\nimport '@ui/modal-bs.js';\nimport constants from './constants';\nimport MembersTable from './members-table';\nimport style from './editors.css?inline';\nimport PendentTable from './pendent-table';\nimport { addParticipant } from '@src/restricted-api-requests';\nimport { errorPublisher } from '../../../../../../event-module';\nimport formsCss from '@ui/bootstrap/forms-css.js';\nimport buttonsCss from '@ui/bootstrap/buttons-css.js';\n\nconst sheet = new CSSStyleSheet();\nsheet.replaceSync(style + formsCss + buttonsCss);\nexport class LdodVeEditors extends HTMLElement {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.attachShadow({ mode: 'open' });\n\t\tthis.shadowRoot.adoptedStyleSheets = [sheet];\n\t}\n\n\tget language() {\n\t\treturn this.getAttribute('language');\n\t}\n\n\tget show() {\n\t\treturn this.hasAttribute('show');\n\t}\n\n\tget modal() {\n\t\treturn this.shadowRoot.querySelector('#virtual-editors-modal');\n\t}\n\n\tget participantUsername() {\n\t\treturn this.shadowRoot.querySelector(\"input[name='participantUsername']\").value;\n\t}\n\n\tstatic get observedAttributes() {\n\t\treturn ['data', 'show'];\n\t}\n\n\tgetConstants(key) {\n\t\treturn constants[this.language][key];\n\t}\n\n\tconnectedCallback() {\n\t\tthis.addEventListener('ldod-modal-close', this.onCloseModal);\n\t}\n\n\tattributeChangedCallback(name, oldV, newV) {\n\t\tthis.onChangedAttribute[name](oldV, newV);\n\t}\n\n\trender() {\n\t\tthis.shadowRoot.innerHTML = '';\n\t\tthis.shadowRoot.appendChild(\n\t\t\t<ldod-bs-modal id=\"virtual-editors-modal\" dialog-class=\"modal-xl\">\n\t\t\t\t<h5 slot=\"header-slot\">\n\t\t\t\t\t<span>{this.edition?.title} - </span>\n\t\t\t\t\t<span>{this.getConstants('editors')}</span>\n\t\t\t\t</h5>\n\t\t\t\t<div slot=\"body-slot\">\n\t\t\t\t\t{this.edition?.member?.admin && (\n\t\t\t\t\t\t<form onSubmit={this.onAdd}>\n\t\t\t\t\t\t\t<div class=\"input-group mb-5\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tstyle={{ height: 'initial', maxWidth: '300px' }}\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tclass=\"form-control\"\n\t\t\t\t\t\t\t\t\tplaceholder=\"username\"\n\t\t\t\t\t\t\t\t\tname=\"participantUsername\"\n\t\t\t\t\t\t\t\t\taria-label=\"participant username\"\n\t\t\t\t\t\t\t\t\taria-describedby=\"add-participant-username\"\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass=\"btn btn-primary\"\n\t\t\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\t\t\tid=\"add-participant-username\">\n\t\t\t\t\t\t\t\t\t{this.getConstants('addMember')}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</form>\n\t\t\t\t\t)}\n\t\t\t\t\t<div style={{ marginTop: '16px', marginBottom: '16px' }}>\n\t\t\t\t\t\t<h6 class=\"text-center\">{this.getConstants('editionMembers')}</h6>\n\t\t\t\t\t\t<MembersTable node={this} />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div style={{ marginTop: '16px', marginBottom: '16px' }}>\n\t\t\t\t\t\t{this.edition.pendingMembers.length && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<h5 class=\"text-center\">{this.getConstants('pendingRequests')}</h5>\n\t\t\t\t\t\t\t\t<PendentTable node={this} />\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</ldod-bs-modal>\n\t\t);\n\t}\n\tisMemberActive = () => this.edition.member?.active;\n\n\tonChangedAttribute = {\n\t\tdata: () => {\n\t\t\tthis.render();\n\t\t\treturn this.isMemberActive()\n\t\t\t\t? this.modal?.toggleAttribute('show', true)\n\t\t\t\t: this.onCloseModal();\n\t\t},\n\t\tshow: (oldV, newV) => {\n\t\t\tthis.render();\n\t\t\tthis.modal?.toggleAttribute('show', this.show);\n\t\t},\n\t};\n\n\tonCloseModal = () => {\n\t\tthis.toggleAttribute('show', false);\n\t\tthis.parent.updateTable();\n\t};\n\n\tonAdd = async e => {\n\t\te.preventDefault();\n\t\taddParticipant(this.edition.externalId, this.participantUsername)\n\t\t\t.then(data => {\n\t\t\t\tthis.edition = data;\n\t\t\t\tthis.toggleAttribute('data');\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tconsole.error(error);\n\t\t\t\terrorPublisher(error?.message);\n\t\t\t});\n\t};\n}\n!customElements.get('ldod-ve-editors') && customElements.define('ldod-ve-editors', LdodVeEditors);\n"],"names":["constants","membersHeaders","pendentHeaders","pt","addMember","username","firstname","lastname","email","role","admin","member","remove","add","pendingRequests","editionMembers","editors","en","es","isAdmin","node","edition","getTableData","participants","filter","active","map","participant","externalId","createElement","is","to","references","user","canSwitchRole","class","type","onClick","async","switchMemberRole","toggleAttribute","onSwitchRole","icon","fill","size","style","marginRight","getConstants","canBeRemoved","removeParticipant","onRemove","search","JSON","stringify","MembersTable","language","id","classes","headers","data","pending","approveParticipant","onAddParticipant","PendentTable","sheet","CSSStyleSheet","replaceSync","formsCss","buttonsCss","LdodVeEditors","HTMLElement","constructor","super","this","attachShadow","mode","shadowRoot","adoptedStyleSheets","getAttribute","show","hasAttribute","modal","querySelector","participantUsername","value","observedAttributes","key","connectedCallback","addEventListener","onCloseModal","attributeChangedCallback","name","oldV","newV","onChangedAttribute","render","innerHTML","appendChild","slot","title","onSubmit","onAdd","height","maxWidth","placeholder","required","marginTop","marginBottom","pendingMembers","length","createFragment","isMemberActive","parent","updateTable","e","preventDefault","addParticipant","then","catch","error","console","errorPublisher","message","customElements","get","define"],"mappings":"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"}