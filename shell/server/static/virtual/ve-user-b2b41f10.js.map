{"version":3,"file":"ve-user-b2b41f10.js","sources":["../src/pages/edition/user/user-ve-component.jsx","../src/pages/edition/user/ldod-user-ve.jsx","../src/pages/edition/user/ve-user.js"],"sourcesContent":["/** @format */\n\nimport references from '@src/references';\nimport { textFragmentInter } from '../../../external-deps';\n\nimport.meta.env.DEV ? await import('@ui/table-dev.js') : await import('@ui/table.js');\n\nexport default ({ node }) => {\n\treturn (\n\t\t<div>\n\t\t\t<h3 class=\"text-center\">\n\t\t\t\t<span>{node.title}</span>\n\t\t\t</h3>\n\t\t\t<div id=\"userVeInfo\">\n\t\t\t\t<p id=\"editions\">\n\t\t\t\t\t<strong data-virtual-key=\"editions\">{node.getConstants('editions')}</strong>\n\t\t\t\t\t<span>: </span>\n\t\t\t\t\t{node.veUser.publicVirtualEditions.map(({ acronym, title }, index) => (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<a is=\"nav-to\" to={references.virtualEdition(acronym)}>\n\t\t\t\t\t\t\t\t{title}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t{index === node.veUser.publicVirtualEditions.length - 1 ? '' : ', '}\n\t\t\t\t\t\t</>\n\t\t\t\t\t))}\n\t\t\t\t</p>\n\t\t\t\t{node.veUser.gameDtos?.length > 0 && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<p id=\"participant\">\n\t\t\t\t\t\t\t<strong data-virtual-key=\"participant\">\n\t\t\t\t\t\t\t\t{node.getConstants('participant')}\n\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t\t<span>: </span>\n\t\t\t\t\t\t\t{node.veUser.gameDtos.map((game, index) => (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\tis=\"nav-to\"\n\t\t\t\t\t\t\t\t\t\tto={references.game(game.veExternalId, game.externalId)}>\n\t\t\t\t\t\t\t\t\t\t{`${game.veTitle} - ${game.title}`}\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t{index === node.veUser.gameDtos.length - 1 ? '' : ', '}\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</p>\n\n\t\t\t\t\t\t<p id=\"points\">\n\t\t\t\t\t\t\t<strong data-virtual-key=\"score\">{node.getConstants('score')}</strong>\n\t\t\t\t\t\t\t<span>: </span>\n\t\t\t\t\t\t\t{node.veUser.score}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p id=\"position\">\n\t\t\t\t\t\t\t<strong data-virtual-key=\"position\">\n\t\t\t\t\t\t\t\t{node.getConstants('position')}\n\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t\t<span>: </span>\n\t\t\t\t\t\t\t{node.veUser.position}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\n\t\t\t\t<p id=\"fragments\">\n\t\t\t\t\t<strong>{node.veUser.fragInters.length || '0'} </strong>\n\t\t\t\t\t<strong data-virtual-key=\"fragments\">{node.getConstants('fragments')}</strong>\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t\t<ldod-table\n\t\t\t\tid=\"virtual-userVeTable\"\n\t\t\t\tclasses=\"table table-bordered table-hover\"\n\t\t\t\theaders={node.constants.userVeHeaders}\n\t\t\t\tdata={node.veUser.fragInters.map(inter => {\n\t\t\t\t\tconst frag = inter.usedList[0];\n\t\t\t\t\treturn {\n\t\t\t\t\t\texternalId: inter.externalId,\n\t\t\t\t\t\tdata: () => ({\n\t\t\t\t\t\t\ttitle: (\n\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\tis=\"nav-to\"\n\t\t\t\t\t\t\t\t\tcontent\n\t\t\t\t\t\t\t\t\tto={textFragmentInter(inter.xmlId, inter.urlId)}>\n\t\t\t\t\t\t\t\t\t{inter.title}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tedition: (\n\t\t\t\t\t\t\t\t<a is=\"nav-to\" to={references.virtualEdition(inter.shortName)}>\n\t\t\t\t\t\t\t\t\t{inter.shortName}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tcategory: inter.categories.map((cat, index, arr) => (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<a is=\"nav-to\" to={references.category(inter.shortName, cat)}>\n\t\t\t\t\t\t\t\t\t\t{cat}\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t{index === arr.length - 1 ? '' : ', '}\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t)),\n\t\t\t\t\t\t\tuseEdition: (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<span>{'-> '}</span>\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\tis=\"nav-to\"\n\t\t\t\t\t\t\t\t\t\tcontent\n\t\t\t\t\t\t\t\t\t\tto={textFragmentInter(frag.xmlId, frag.urlId)}>\n\t\t\t\t\t\t\t\t\t\t{frag.shortName}\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tsearch: JSON.stringify(inter),\n\t\t\t\t\t};\n\t\t\t\t})}\n\t\t\t\tconstants={node.constants}\n\t\t\t\tlanguage={node.language}\n\t\t\t\tdata-searchkey=\"externalId\"></ldod-table>\n\t\t</div>\n\t);\n};\n","import thisConstants from '../constants';\nimport constants from '../../constants';\nimport style from '../ve-style.css?inline';\nimport UserVeComponent from './user-ve-component';\nimport { getVeUser } from '../api-requests';\n\nexport class LdodUserVe extends HTMLElement {\n  constructor(lang) {\n    super();\n    this.language = lang;\n    this.constants = Object.entries(thisConstants).reduce(\n      (prev, [key, value]) => {\n        prev[key] =\n          value instanceof Array ? value : { ...constants[key], ...value };\n        return prev;\n      },\n      {}\n    );\n  }\n\n  set language(lang) {\n    this.setAttribute('language', lang);\n  }\n\n  get language() {\n    return this.getAttribute('language');\n  }\n\n  get title() {\n    return `${this.veUser.firstname} ${this.veUser.lastname} (${this.veUser.username})`;\n  }\n\n  static get observedAttributes() {\n    return ['language'];\n  }\n\n  fetchData = async () => {\n    await getVeUser(history.state?.username)\n      .then((data) => (this.veUser = data))\n      .catch((error) => console.error(error));\n  };\n\n  getConstants = (key) => this.constants[this.language][key];\n\n  async connectedCallback() {\n    await this.fetchData();\n    this.render();\n  }\n\n  render = () => {\n    this.appendChild(<style>{style}</style>);\n    this.appendChild(<UserVeComponent node={this} />);\n  };\n\n  attributeChangedCallback(name, oldV, newV) {\n    this.onChangeAttribute[name](oldV, newV);\n  }\n\n  onChangeAttribute = {\n    language: (oldV, newV) =>\n      oldV && oldV !== newV && this.handleChangeLanguage(),\n  };\n\n  handleChangeLanguage = () => {\n    this.querySelectorAll('[data-virtual-key]').forEach((ele) => {\n      ele.firstChild.textContent = this.getConstants(ele.dataset.virtualKey);\n    });\n  };\n\n  disconnectedCallback() { }\n}\n!customElements.get('ldod-user-ve') &&\n  customElements.define('ldod-user-ve', LdodUserVe);\n","import { LdodUserVe } from './ldod-user-ve';\n\nconst mount = async (lang, ref) => {\n  document.querySelector(ref).appendChild(new LdodUserVe(lang));\n};\n\nconst unMount = () => document.querySelector('ldod-user-ve')?.remove();\n\nconst path = '/user/:username';\n\nexport { mount, unMount, path };\n"],"names":["import","UserVeComponent","node","createElement","class","title","id","getConstants","veUser","publicVirtualEditions","map","acronym","index","createFragment","is","to","references","virtualEdition","length","gameDtos","game","veExternalId","externalId","veTitle","score","position","fragInters","classes","headers","constants","userVeHeaders","data","inter","frag","usedList","content","textFragmentInter","xmlId","urlId","edition","shortName","category","categories","cat","arr","useEdition","search","JSON","stringify","language","LdodUserVe","HTMLElement","constructor","lang","this","Object","entries","thisConstants","reduce","prev","key","value","Array","setAttribute","getAttribute","firstname","lastname","username","observedAttributes","fetchData","async","getVeUser","history","state","then","catch","error","console","render","appendChild","style","attributeChangedCallback","name","oldV","newV","onChangeAttribute","handleChangeLanguage","querySelectorAll","forEach","ele","firstChild","textContent","dataset","virtualKey","disconnectedCallback","customElements","get","define","mount","ref","document","querySelector","unMount","remove","path"],"mappings":"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"}