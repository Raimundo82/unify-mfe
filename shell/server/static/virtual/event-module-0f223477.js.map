{"version":3,"file":"event-module-0f223477.js","sources":["../src/event-module.js"],"sourcesContent":["/** @format */\n\nimport { references } from './virtual';\nimport { ldodEventPublisher, ldodEventSubscriber, ldodEventBus } from '@core';\nexport let selectedVEs = ['LdoD-Arquivo'];\nconst errorPublisher = error => ldodEventPublisher('error', error);\nconst selectedVePublisher = ve => ldodEventPublisher('selected-ve', ve);\nconst updateSelecteVEs = ves => ves.forEach(selectedVePublisher);\nconst messagePublisher = info => ldodEventPublisher('message', info);\nconst loadingPublisher = bool => ldodEventPublisher('loading', bool);\n\nldodEventSubscriber('selected-ve', selectedVeHandler);\nldodEventSubscriber('login', ({ payload }) => {\n\tselectedVEs = ['LdoD-Arquivo', ...payload.selectedVE];\n\tupdateEditions();\n});\n\nldodEventSubscriber('logout', () => {\n\tselectedVEs = ['LdoD-Arquivo'];\n\tupdateEditions();\n});\n\nconst virtualEditionAdminMenuLinks = {\n\tname: 'admin',\n\thidden: true,\n\tdata: {\n\t\tname: 'admin',\n\t\tlinks: [{ key: 've_management', route: references.manageVirtualEditions() }],\n\t},\n\tconstants: {\n\t\tpt: {\n\t\t\tve_management: 'Gerir Edições Virtuais',\n\t\t},\n\t\ten: {\n\t\t\tve_management: 'Manage Virtual Editions',\n\t\t},\n\t\tes: {\n\t\t\tve_management: 'Administrar Ediciones Virtuales',\n\t\t},\n\t},\n};\n\ncustomElements.whenDefined('nav-bar').then(() => {\n\tupdateEditions();\n\tldodEventBus.publish('ldod:header', virtualEditionAdminMenuLinks);\n});\n\nfunction selectedVeHandler({ payload }) {\n\tselectedVEs = payload.selected\n\t\t? [...selectedVEs, payload.name]\n\t\t: selectedVEs.filter(ed => ed !== payload.name);\n\tselectedVEs = [...new Set(selectedVEs)];\n\tupdateEditions();\n}\n\nfunction updateEditions() {\n\tldodEventBus.publish('text:editions-menu-links', {\n\t\tlinks: selectedVEs.map(ed => ({ key: ed, route: `/virtual/edition/acronym/${ed}` })),\n\t});\n}\n\nexport {\n\terrorPublisher,\n\tloadingPublisher,\n\tselectedVePublisher,\n\tmessagePublisher,\n\tupdateSelecteVEs,\n};\n"],"names":["selectedVEs","errorPublisher","error","ldodEventPublisher","selectedVePublisher","ve","updateSelecteVEs","ves","forEach","messagePublisher","info","loadingPublisher","bool","ldodEventSubscriber","payload","selected","name","filter","ed","Set","updateEditions","selectedVE","virtualEditionAdminMenuLinks","hidden","data","links","key","route","references","manageVirtualEditions","constants","pt","ve_management","en","es","ldodEventBus","publish","map","customElements","whenDefined","then"],"mappings":"gIAIU,IAACA,EAAc,CAAC,gBACrB,MAACC,EAAiBC,GAASC,EAAmB,QAASD,GACtDE,EAAsBC,GAAMF,EAAmB,cAAeE,GAC9DC,EAAmBC,GAAOA,EAAIC,QAAQJ,GACtCK,EAAmBC,GAAQP,EAAmB,UAAWO,GACzDC,EAAmBC,GAAQT,EAAmB,UAAWS,GAE/DC,EAAoB,eAoCpB,UAA6BC,QAAAA,IAC5Bd,EAAcc,EAAQC,SACnB,IAAIf,EAAac,EAAQE,MACzBhB,EAAYiB,QAAOC,GAAMA,IAAOJ,EAAQE,OAC3ChB,EAAc,IAAI,IAAImB,IAAInB,IAC1BoB,GACD,IAzCAP,EAAoB,SAAS,EAAGC,QAAAA,MAC/Bd,EAAc,CAAC,kBAAmBc,EAAQO,YAC1CD,OAGDP,EAAoB,UAAU,KAC7Bb,EAAc,CAAC,gBACfoB,OAGD,MAAME,EAA+B,CACpCN,KAAM,QACNO,QAAQ,EACRC,KAAM,CACLR,KAAM,QACNS,MAAO,CAAC,CAAEC,IAAK,gBAAiBC,MAAOC,EAAWC,2BAEnDC,UAAW,CACVC,GAAI,CACHC,cAAe,0BAEhBC,GAAI,CACHD,cAAe,2BAEhBE,GAAI,CACHF,cAAe,qCAkBlB,SAASZ,IACRe,EAAaC,QAAQ,2BAA4B,CAChDX,MAAOzB,EAAYqC,KAAInB,IAAAA,CAASQ,IAAKR,EAAIS,MAAO,4BAA4BT,SAE9E,CAjBAoB,eAAeC,YAAY,WAAWC,MAAK,KAC1CpB,IACAe,EAAaC,QAAQ,cAAed,EAA4B"}