{"version":3,"file":"ve-category-c9b8bd86.js","sources":["../src/pages/edition/category/category-ve-component.jsx","../src/pages/edition/category/ldod-ve-category.jsx","../src/pages/edition/category/ve-category.js"],"sourcesContent":["/** @format */\n\nimport references from '@src/references';\nimport { textFragmentInter } from '../../../external-deps';\n\nimport.meta.env.DEV ? await import('@ui/table-dev.js') : await import('@ui/table.js');\n\nexport default ({ node }) => {\n\treturn (\n\t\t<div>\n\t\t\t<h3 class=\"text-center\">\n\t\t\t\t<span data-virtual-key=\"category\">{node.getConstants('category')}</span>:{' '}\n\t\t\t\t<span>{node.name}</span>\n\t\t\t</h3>\n\t\t\t<div id=\"categoryInfo\">\n\t\t\t\t<p id=\"taxonomy\">\n\t\t\t\t\t<strong data-virtual-key=\"taxonomy\">{node.getConstants('taxonomy')}</strong>\n\t\t\t\t\t<span>: </span>\n\t\t\t\t\t{\n\t\t\t\t\t\t<a is=\"nav-to\" to={references.taxonomy(node.category?.veAcronym)}>\n\t\t\t\t\t\t\t{node.category?.veTitle}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t}\n\t\t\t\t</p>\n\n\t\t\t\t<p id=\"fragments\">\n\t\t\t\t\t<strong>{node.category?.veInters.length || '0'} </strong>\n\t\t\t\t\t<strong data-virtual-key=\"fragments\">{node.getConstants('fragments')}</strong>\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t\t<ldod-table\n\t\t\t\tid=\"virtual-categoryVeTable\"\n\t\t\t\tclasses=\"table table-bordered table-hover\"\n\t\t\t\theaders={node.constants.categoryVeHeaders}\n\t\t\t\tdata={node.category.veInters.map(inter => {\n\t\t\t\t\tconst frag = inter.usedList[0];\n\t\t\t\t\tconst users = inter.users;\n\t\t\t\t\treturn {\n\t\t\t\t\t\texternalId: inter.externalId,\n\t\t\t\t\t\tdata: () => ({\n\t\t\t\t\t\t\ttitle: (\n\t\t\t\t\t\t\t\t<a is=\"nav-to\" to={textFragmentInter(inter.xmlId, inter.urlId)}>\n\t\t\t\t\t\t\t\t\t{inter.title}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tvirtualEdition: (\n\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\tis=\"nav-to\"\n\t\t\t\t\t\t\t\t\tto={references.virtualEdition(inter.shortName)}>\n\t\t\t\t\t\t\t\t\t{inter.editionTitle}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tuser: users.map(user => (\n\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\tis=\"nav-to\"\n\t\t\t\t\t\t\t\t\tto={references.user(\n\t\t\t\t\t\t\t\t\t\tuser.username\n\t\t\t\t\t\t\t\t\t)}>{`${user.firstname} ${user.lastname} (${user.username})`}</a>\n\t\t\t\t\t\t\t)),\n\n\t\t\t\t\t\t\tuseEdition: (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<span>{'-> '}</span>\n\t\t\t\t\t\t\t\t\t<a is=\"nav-to\" to={textFragmentInter(frag.xmlId, frag.urlId)}>\n\t\t\t\t\t\t\t\t\t\t{frag.shortName}\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tsearch: JSON.stringify(inter),\n\t\t\t\t\t};\n\t\t\t\t})}\n\t\t\t\tconstants={node.constants}\n\t\t\t\tlanguage={node.language}\n\t\t\t\tdata-searchkey=\"externalId\"></ldod-table>\n\t\t</div>\n\t);\n};\n","import { getCategoryData } from '../api-requests';\nimport thisConstants from '../constants';\nimport constants from '../../constants';\nimport style from '../ve-style.css?inline';\nimport CategoryVeComponent from './category-ve-component';\n\nexport class LdodVeCategory extends HTMLElement {\n  constructor(lang) {\n    super();\n    this.language = lang;\n    this.constants = Object.entries(thisConstants).reduce(\n      (prev, [key, value]) => {\n        prev[key] =\n          value instanceof Array ? value : { ...constants[key], ...value };\n        return prev;\n      },\n      {}\n    );\n  }\n\n  set language(lang) {\n    this.setAttribute('language', lang);\n  }\n\n  get language() {\n    return this.getAttribute('language');\n  }\n\n  static get observedAttributes() {\n    return ['language'];\n  }\n\n  get name() {\n    return this.category?.name;\n  }\n  get title() {\n    return this.category?.title;\n  }\n  get acronym() {\n    return this.category?.acronym;\n  }\n\n  fetchData = async ({ acrn, cat }) => {\n    await getCategoryData(acrn, cat)\n      .then((data) => (this.category = data))\n      .catch((error) => console.error(error));\n  };\n\n  getConstants = (key) => this.constants[this.language][key];\n\n  async connectedCallback() {\n    await this.fetchData(history.state);\n    this.render();\n  }\n\n  render = () => {\n    this.appendChild(<style>{style}</style>);\n    this.appendChild(<CategoryVeComponent node={this} />);\n  };\n\n  attributeChangedCallback(name, oldV, newV) {\n    this.onChangeAttribute[name](oldV, newV);\n  }\n\n  onChangeAttribute = {\n    language: (oldV, newV) =>\n      oldV && oldV !== newV && this.handleChangeLanguage(),\n  };\n\n  handleChangeLanguage = () => {\n    this.querySelectorAll('[data-virtual-key]').forEach((ele) => {\n      ele.firstChild.textContent = this.getConstants(ele.dataset.virtualKey);\n    });\n  };\n\n  disconnectedCallback() { }\n}\n!customElements.get('ldod-ve-category') &&\n  customElements.define('ldod-ve-category', LdodVeCategory);\n","import { LdodVeCategory } from './ldod-ve-category';\n\nconst mount = async (lang, ref) => {\n  document.querySelector(ref).appendChild(new LdodVeCategory(lang));\n};\n\nconst unMount = () => document.querySelector('ldod-ve-category')?.remove();\n\nconst path = '/acronym/:acrn/category/:cat';\n\nexport { mount, unMount, path };\n"],"names":["import","CategoryVeComponent","node","createElement","class","getConstants","name","id","is","to","references","taxonomy","category","veAcronym","veTitle","veInters","length","classes","headers","constants","categoryVeHeaders","data","map","inter","frag","usedList","users","externalId","title","textFragmentInter","xmlId","urlId","virtualEdition","shortName","editionTitle","user","username","firstname","lastname","useEdition","createFragment","search","JSON","stringify","language","LdodVeCategory","HTMLElement","constructor","lang","this","Object","entries","thisConstants","reduce","prev","key","value","Array","setAttribute","getAttribute","observedAttributes","acronym","fetchData","async","acrn","cat","getCategoryData","then","catch","error","console","history","state","render","appendChild","style","attributeChangedCallback","oldV","newV","onChangeAttribute","handleChangeLanguage","querySelectorAll","forEach","ele","firstChild","textContent","dataset","virtualKey","disconnectedCallback","customElements","get","define","mount","ref","document","querySelector","unMount","remove","path"],"mappings":"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"}