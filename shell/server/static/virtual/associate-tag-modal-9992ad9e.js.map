{"version":3,"file":"associate-tag-modal-9992ad9e.js","sources":["../src/fragment/components/associate-tag-modal/associate-tag-modal.jsx"],"sourcesContent":["/** @format */\n\nimport '@src/select-pure.js';\nimport '@ui/modal-bs.js';\nimport style from './style.css?inline';\n\nconst selectPure = root => root.associateTagModal.querySelector('select-pure#virtual-associateTag');\n\nconst anyTagIsEqual = (tags, tag) => tags.some(t => t === tag);\n\nconst onAutocomplete = (e, root, inter) => {\n\tconst nonAssignedCats = inter.notAssignedCategories.map(cat => cat.name);\n\tconst assignedCats = inter.categories.map(cat => cat.name);\n\n\tconst target = e.target;\n\n\tconst matches = nonAssignedCats.filter(cat =>\n\t\tcat.toLowerCase().startsWith(target.value.toLowerCase())\n\t);\n\n\tArray.from(selectPure(root).querySelectorAll('option-pure')).forEach(option => {\n\t\tif (option.hasAttribute('selected') || matches.includes(option.getAttribute('value')))\n\t\t\treturn (option.hidden = false);\n\t\toption.hidden = true;\n\t});\n\n\tif (e.key === 'Enter' && !anyTagIsEqual(matches, target.value) && root.taxonomy.openVocab) {\n\t\tselectPure(root)\n\t\t\t.shadowRoot.querySelectorAll('div.multi-selected-wrapper span.multi-selected')\n\t\t\t.forEach(span => span.remove());\n\n\t\tselectPure(root)\n\t\t\t.querySelectorAll('option-pure[selected]')\n\t\t\t.forEach(option => option.remove());\n\n\t\t!assignedCats.includes(target.value) && assignedCats.push(e.target.value);\n\t\t!inter.categories.map(c => c.name).includes(target.value) &&\n\t\t\tinter.categories.push({ name: target.value });\n\n\t\tselectPure(root).append(\n\t\t\t...assignedCats.map(cat => (\n\t\t\t\t<option-pure selected value={cat}>\n\t\t\t\t\t{cat}\n\t\t\t\t</option-pure>\n\t\t\t))\n\t\t);\n\t}\n};\n\nexport default ({ root, inter }) => {\n\treturn (\n\t\t<ldod-bs-modal id=\"virtual--associate-tag-modal\" dialog-class=\"modal-xl\">\n\t\t\t<style>{style}</style>\n\t\t\t<span slot=\"header-slot\">\n\t\t\t\t<span>{inter.title}</span>\n\t\t\t</span>\n\t\t\t<div slot=\"body-slot\">\n\t\t\t\t<div id=\"multipleSelectContainer\" style={{ padding: '20px' }}>\n\t\t\t\t\t<select-pure id=\"virtual-associateTag\" name=\"categories\" multiple>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tid=\"select-pure-autocomplete\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tplaceholder={root.getConstants('newCategory')}\n\t\t\t\t\t\t\tonKeyUp={e => onAutocomplete(e, root, inter)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{inter.notAssignedCategories.map(cat => (\n\t\t\t\t\t\t\t<option-pure value={cat.name}>{cat.name}</option-pure>\n\t\t\t\t\t\t))}\n\t\t\t\t\t\t{inter.categories.map(cat => (\n\t\t\t\t\t\t\t<option-pure selected value={cat.name}>\n\t\t\t\t\t\t\t\t{cat.name}\n\t\t\t\t\t\t\t</option-pure>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</select-pure>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div slot=\"footer-slot\">\n\t\t\t\t<button type=\"button\" class=\"btn btn-primary\" onClick={root.onAssociateTags}>\n\t\t\t\t\t<span>{root.getConstants('associate')}</span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</ldod-bs-modal>\n\t);\n};\n"],"names":["selectPure","root","associateTagModal","querySelector","inter","id","createElement","slot","title","style","padding","name","multiple","type","placeholder","getConstants","onKeyUp","e","nonAssignedCats","notAssignedCategories","map","cat","assignedCats","categories","target","matches","filter","toLowerCase","startsWith","value","Array","from","querySelectorAll","forEach","option","hasAttribute","includes","getAttribute","hidden","key","tags","tag","some","t","anyTagIsEqual","taxonomy","openVocab","shadowRoot","span","remove","push","c","append","selected","onAutocomplete","class","onClick","onAssociateTags"],"mappings":"sGAMMA,EAAaC,GAAQA,EAAKC,kBAAkBC,cAAc,oCA2ChED,EAAe,EAAGD,KAAAA,EAAMG,MAAAA,OAErB,gBAAc,CAAAC,GAAG,+BAA+B,eAAa,cAC5D,QAAO,g1BACRC,EAAC,QAAKC,KAAK,iBACT,OAAM,KAAAH,EAAMI,QAEbF,EAAA,MAAA,CAAIC,KAAK,aACTD,EAAC,OAAID,GAAG,0BAA0BI,MAAO,CAAEC,QAAS,WAClD,cAAY,CAAAL,GAAG,uBAAuBM,KAAK,aAAaC,UAAQ,GAChEN,EAAC,QAAA,CACAD,GAAG,2BACHQ,KAAK,OACLC,YAAab,EAAKc,aAAa,eAC/BC,QAASC,GArDO,EAACA,EAAGhB,EAAMG,KAC1Bc,MAAAA,EAAkBd,EAAMe,sBAAsBC,KAAIC,GAAOA,EAAIV,OAC7DW,EAAelB,EAAMmB,WAAWH,KAAIC,GAAOA,EAAIV,OAE/Ca,EAASP,EAAEO,OAEXC,EAAUP,EAAgBQ,QAAOL,GACtCA,EAAIM,cAAcC,WAAWJ,EAAOK,MAAMF,iBAGrCG,MAAAC,KAAK/B,EAAWC,GAAM+B,iBAAiB,gBAAgBC,SAAkBC,IAC1EA,GAAAA,EAAOC,aAAa,aAAeV,EAAQW,SAASF,EAAOG,aAAa,UAC3E,OAAQH,EAAOI,QAAS,EACzBJ,EAAOI,QAAS,CAAA,IAGH,UAAVrB,EAAEsB,MAlBe,EAACC,EAAMC,IAAQD,EAAKE,MAAKC,GAAKA,IAAMF,IAkB/BG,CAAcnB,EAASD,EAAOK,QAAU5B,EAAK4C,SAASC,YACpE9C,EAAAC,GACT8C,WAAWf,iBAAiB,kDAC5BC,SAAQe,GAAQA,EAAKC,WAEZjD,EAAAC,GACT+B,iBAAiB,yBACjBC,SAAQC,GAAUA,EAAOe,YAE1B3B,EAAac,SAASZ,EAAOK,QAAUP,EAAa4B,KAAKjC,EAAEO,OAAOK,QAClEzB,EAAMmB,WAAWH,QAAS+B,EAAExC,OAAMyB,SAASZ,EAAOK,QAClDzB,EAAMmB,WAAW2B,KAAK,CAAEvC,KAAMa,EAAOK,QAEtC7B,EAAWC,GAAMmD,UACb9B,EAAaF,KACfC,GAAAf,EAAC,cAAY,CAAA+C,UAAQ,EAACxB,MAAOR,GAC3BA,MAEF,EAmBiBiC,CAAerC,EAAGhB,EAAMG,KAEtCA,EAAMe,sBAAsBC,KAAIC,KAC/B,cAAY,CAAAQ,MAAOR,EAAIV,MAAOU,EAAIV,QAEnCP,EAAMmB,WAAWH,KACjBC,GAAAf,EAAC,eAAY+C,UAAQ,EAACxB,MAAOR,EAAIV,MAC/BU,EAAIV,WAMVL,EAAC,OAAIC,KAAK,eACRD,EAAA,SAAA,CAAOO,KAAK,SAAS0C,MAAM,kBAAkBC,QAASvD,EAAKwD,iBAC1DnD,EAAA,OAAA,KAAML,EAAKc,aAAa"}