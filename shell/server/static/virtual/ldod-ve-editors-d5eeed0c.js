import{createElement as e,createFragment as t}from"@core";import"@ui/modal-bs.js";import{d as a,e as i,f as n,h as s}from"./virtual-editions-router-09df2ce5.js";import{references as r}from"./virtual.js";import{errorPublisher as o}from"./event-module-0f223477.js";import d from"@ui/bootstrap/forms-css.js";import l from"@ui/bootstrap/buttons-css.js";import"./constants-833df29c.js";const m={membersHeaders:["username","firstname","lastname","email","role","remove"],pendentHeaders:["username","firstname","lastname","email","add"],pt:{addMember:"Adicionar membro",username:"Nome de utilizador",firstname:"Primeiro nome",lastname:"Apelido",email:"e-mail",role:"Papel",admin:"Gestor",member:"Editor",remove:"Remover",add:"Adicionar",pendingRequests:"Pedidos de adesão",editionMembers:"Membros da Edição",editors:"Editores"},en:{addMember:"Add member",username:"Username",firstname:"First name",lastname:"Surname",email:"e-mail",role:"Role",admin:"Manager",member:"Editor",remove:"Remove",add:"Add",pendingRequests:"Membership applications",editionMembers:"Edition Members",editors:"Editors"},es:{addMember:"Añadir miembro",username:"Nome de utilizador",firstname:"Primeiro nome",lastname:"Apelido",email:"e-mail",role:"Papel",admin:"Gestor",member:"Editor",remove:"Remover",add:"Adicionar",pendingRequests:"Solicitud de Adhesión ",editionMembers:"Miembros de la Edicíon ",editors:"Editores"}},h=e=>e.edition?.member?.admin,u=t=>t.edition.participants.filter((({active:e})=>e)).map((n=>({externalId:n.externalId,username:e("a",{is:"nav-to",to:r.user(n.username)},n.username),firstname:n.firstname,lastname:n.lastname,email:n.email,role:h(t)&&n.canSwitchRole?e("button",{class:"btn btn-primary btn-sm",type:"button",onClick:()=>(async(e,t)=>{e.edition=await a(e.edition.externalId,t),e.toggleAttribute("data")})(t,n.username)},e("span",{is:"ldod-span-icon",icon:"rotate",fill:"#fff",size:"14px",style:{marginRight:"8px"}}),t.getConstants(n.admin?"admin":"member")):t.getConstants(n.admin?"admin":"member"),remove:n.canBeRemoved&&e("div",{class:"center-container"},e("span",{class:"icon-size icon-minus",onClick:()=>(async(e,t)=>{e.edition=await i(e.edition.externalId,t),e.toggleAttribute("data")})(t,n.username)})),search:JSON.stringify(n)}))),c=({node:t})=>e("ldod-table",{language:t.language,id:"virtual-veMembers",classes:"table  table-hover",headers:m.membersHeaders,data:u(t),constants:m,"data-searchkey":"externalId"}),b=e=>e.edition?.member?.admin,p=t=>t.edition.participants.filter((({pending:e})=>e)).map((a=>({externalId:a.externalId,username:e("a",{is:"nav-to",to:r.user(a.username)},a.username),firstname:a.firstname,lastname:a.lastname,email:a.email,add:b(t)&&e("div",{class:"center-container"},e("span",{class:"icon-size icon-add",onClick:()=>(async(e,t)=>{e.edition=await n(e.edition.externalId,t),e.toggleAttribute("data",!0)})(t,a.username)})),search:JSON.stringify(a)}))),v=({node:t})=>e("ldod-table",{language:t.language,id:"virtual-vePendents",classes:"table table-hover",headers:m.pendentHeaders,data:p(t),constants:m,"data-searchkey":"externalId"}),g=new CSSStyleSheet;g.replaceSync("ldod-table#virtual-veMembers .table-container,ldod-table#virtual-vePendents .table-container{border:none!important}table#virtual-veMembers,table#virtual-vePendents{border-collapse:collapse!important}table#virtual-veMembers th,table#virtual-vePendents th{border-top:none!important}table#virtual-vePendents th:nth-child(1),table#virtual-vePendents th:nth-child(2),table#virtual-vePendents th:nth-child(3),table#virtual-vePendents th:nth-child(4),table#virtual-veMembers th:nth-child(1),table#virtual-veMembers th:nth-child(2),table#virtual-veMembers th:nth-child(3),table#virtual-veMembers th:nth-child(4){text-align:start}table#virtual-veMembers td:nth-child(5),table#virtual-veMembers td:nth-child(6),table#virtual-vePendents td:nth-child(5){text-align:center}\n"+d+l);class M extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.adoptedStyleSheets=[g]}get language(){return this.getAttribute("language")}get show(){return this.hasAttribute("show")}get modal(){return this.shadowRoot.querySelector("#virtual-editors-modal")}get participantUsername(){return this.shadowRoot.querySelector("input[name='participantUsername']").value}static get observedAttributes(){return["data","show"]}getConstants(e){return m[this.language][e]}connectedCallback(){this.addEventListener("ldod-modal-close",this.onCloseModal)}attributeChangedCallback(e,t,a){this.onChangedAttribute[e](t,a)}render(){this.shadowRoot.innerHTML="",this.shadowRoot.appendChild(e("ldod-bs-modal",{id:"virtual-editors-modal","dialog-class":"modal-xl"},e("h5",{slot:"header-slot"},e("span",null,this.edition?.title," - "),e("span",null,this.getConstants("editors"))),e("div",{slot:"body-slot"},this.edition?.member?.admin&&e("form",{onSubmit:this.onAdd},e("div",{class:"input-group mb-5"},e("input",{style:{height:"initial",maxWidth:"300px"},type:"text",class:"form-control",placeholder:"username",name:"participantUsername","aria-label":"participant username","aria-describedby":"add-participant-username",required:!0}),e("button",{class:"btn btn-primary",type:"submit",id:"add-participant-username"},this.getConstants("addMember")))),e("div",{style:{marginTop:"16px",marginBottom:"16px"}},e("h6",{class:"text-center"},this.getConstants("editionMembers")),e(c,{node:this})),e("div",{style:{marginTop:"16px",marginBottom:"16px"}},this.edition.pendingMembers.length&&e(t,null,e("h5",{class:"text-center"},this.getConstants("pendingRequests")),e(v,{node:this}))))))}isMemberActive=()=>this.edition.member?.active;onChangedAttribute={data:()=>(this.render(),this.isMemberActive()?this.modal?.toggleAttribute("show",!0):this.onCloseModal()),show:(e,t)=>{this.render(),this.modal?.toggleAttribute("show",this.show)}};onCloseModal=()=>{this.toggleAttribute("show",!1),this.parent.updateTable()};onAdd=async e=>{e.preventDefault(),s(this.edition.externalId,this.participantUsername).then((e=>{this.edition=e,this.toggleAttribute("data")})).catch((e=>{console.error(e),o(e?.message)}))}}!customElements.get("ldod-ve-editors")&&customElements.define("ldod-ve-editors",M);export{M as LdodVeEditors};
//# sourceMappingURL=ldod-ve-editors-d5eeed0c.js.map
