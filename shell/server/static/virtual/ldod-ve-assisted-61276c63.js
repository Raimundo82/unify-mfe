import{createElement as t}from"@core";import{t as e}from"./constants-3a8e8d70.js";import{c as s}from"./constants-833df29c.js";import{a,b as o}from"./virtual-editions-router-09df2ce5.js";import{t as r}from"./external-deps-beceb3c1.js";import n from"@ui/bootstrap/forms-css.js";import i from"@ui/bootstrap/buttons-css.js";import"./virtual.js";import"./event-module-0f223477.js";const l=[{type:"heteronym",weight:"0"},{type:"date",weight:"0"},{type:"text",weight:"0"},{type:"taxonomy",weight:"0"}];let d=l;const c=()=>[t=>(d??l).map((e=>({...e,acronym:t}))),(t=l)=>d=t],[p,h]=c(),u=e=>e.inters.map((s=>{const o=s.usedList[0];return{externalId:s.externalId,number:s.number,title:s.title,selected:e.selected!==s.externalId?t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:()=>(async(t,e)=>{h(t.properties);const s=await a(t.edition.externalId,{selected:e.externalId,properties:p(e.shortName)});t.updateData(s)})(e,s)},e.getConstants("defineFirst")):"",useEdition:t("a",{target:"_blank",is:"nav-to",to:`/ldod-mfes${r(o.xmlId,o.urlId)}`},`-> ${o.shortName}`),search:JSON.stringify(s)}})),m=({node:e})=>t("ldod-table",{language:e.language,id:"virtual-assistedTable",classes:"table  table-hover",headers:e.constants.assistedHeaders,data:u(e),constants:e.constants,"data-searchkey":"externalId"}),b=async t=>{let e=(t=>Array.from(t.shadowRoot.querySelectorAll('input[type="range"]')))(t).map((t=>({type:t.name,weight:t.value})));t.properties.set(e);const s=await a(t.parent.edition.externalId,{selected:t.parent.selected,properties:t.properties.get(t.parent.edition.acronym)});t.parent.updateData(s)};class g extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){}get properties(){const[t,e]=c();return{get:t,set:e}}connectedCallback(){var e,s;this.properties.set(),this.shadowRoot.appendChild(t("style",null,"input[type=range]{width:100%;display:block}.text-center{text-align:center}label{font-weight:700}span.icon{float:left;margin-top:3px;width:15px;height:15px}span.save-icon{margin-right:8px;background:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 448 512'%3E%3Cpath fill='%23fff' d='M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V173.3c0-17-6.7-33.3-18.7-45.3L352 50.7C340 38.7 323.7 32 306.7 32H64zm0 96c0-17.7 14.3-32 32-32H288c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V128zM224 416c-35.3 0-64-28.7-64-64s28.7-64 64-64s64 28.7 64 64s-28.7 64-64 64z'/%3E%3C/svg%3E\") center no-repeat;background-size:15px}.btn{display:inline-block;font-weight:400;line-height:1.5;color:#212529;text-align:center;text-decoration:none;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:.375rem .75rem;font-size:1rem;border-radius:.25rem;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;max-width:300px}.btn-primary{color:#fff;background-color:#0d6efd;border-color:#0d6efd}.btn-primary:hover{color:#fff;background-color:#0b5ed7;border-color:#0a58ca}\n")),this.shadowRoot.appendChild((e=this,s=this.parent,t("form",null,t("h4",{class:"text-center"},s.getConstants("criteria")),t("div",{style:{display:"grid",gap:"20px",margin:"20px",justifyContent:"space-evenly",gridTemplateColumns:"auto auto auto auto"}},["heteronym","date","text","taxonomy"].map((a=>t("div",{class:" text-center"},t("label",{for:`range-${a}`},s.getConstants(a)),t("input",{onChange:()=>b(e),id:`range-${a}`,name:a,type:"range",max:"1",min:"0",step:"0.2",value:`${s.properties?.filter((({type:t})=>a===t))[0]?.weight||0}`}))))))))}attributeChangedCallback(){}disconnectedCallback(){}}!customElements.get("properties-form")&&customElements.define("properties-form",g);const y=new CSSStyleSheet;y.replaceSync("ldod-table#virtual-assistedTable .table-container{border:none!important}table#virtual-assistedTable{border-collapse:collapse!important}table#virtual-assistedTable th{border-top:none!important}table#virtual-assistedTable th:nth-child(1),table#virtual-assistedTable th:nth-child(3),table#virtual-assistedTable th:nth-child(4),table#virtual-assistedTable td:nth-child(1),table#virtual-assistedTable td:nth-child(3),table#virtual-assistedTable td:nth-child(4){text-align:center}\n"+i+n);class f extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.adoptedStyleSheets=[y],this.constants=Object.entries(e).reduce(((t,[e,a])=>(t[e]=a instanceof Array?a:{...s[e],...a},t)),{})}get language(){return this.getAttribute("language")}get show(){return this.hasAttribute("show")}get modal(){return this.shadowRoot.querySelector("#virtual-veAssisted")}get table(){return this.shadowRoot.querySelector("ldod-table#virtual-assistedTable")}static get observedAttributes(){return["show"]}getConstants(t){return this.constants[this.language][t]}connectedCallback(){this.addEventListener("ldod-modal-close",this.onCloseModal)}attributeChangedCallback(t,e,s){this.onChangedAttribute[t](e,s)}onCloseModal=()=>{this.toggleAttribute("show",!1),this.shadowRoot.innerHTML=""};onSave=async()=>{const t=await o(this.edition.externalId,this.inters.map((({externalId:t})=>t)));this.shadowRoot.querySelector("properties-form").shadowRoot.querySelectorAll('input[type="range"]').forEach((t=>t.value=0)),this.updateData(t)};render(){this.shadowRoot.appendChild(t("ldod-bs-modal",{id:"virtual-veAssisted","dialog-class":"modal-fullscreen"},t("h5",{slot:"header-slot"},this.edition?.title),t("div",{slot:"body-slot"},t("properties-form",{parent:this}),t(m,{node:this})),t("div",{slot:"footer-slot"},t("button",{type:"button",class:"btn btn-primary",onClick:this.onSave},t("span",{is:"ldod-span-icon",icon:"floppy-disk",fill:"#fff",size:"16px",style:{marginRight:"8px"}}),this.getConstants("save")))))}updateData=({inters:t,selected:e,properties:s})=>{this.inters=t,this.selected=e,this.properties=s?.map((({title:t,acronym:e,weight:s})=>({type:t.toLowerCase(),acronym:e,weight:s}))),this.reRenderTable()};reRenderTable(){console.log(this.table),this.table?.replaceWith(t(m,{node:this}))}onChangedAttribute={show:()=>{console.log("show"),this.show&&this.render(),this.modal?.toggleAttribute("show",this.show)}}}!customElements.get("ldod-ve-assisted")&&customElements.define("ldod-ve-assisted",f);export{f as LdodVeAssisted};
//# sourceMappingURL=ldod-ve-assisted-61276c63.js.map
